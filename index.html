<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Surat Keterangan Pindah - 5 Halaman</title>
    <style>
        body {
            margin: 0;
            padding: 0;
            font-family: 'BookmanOldStyle', serif;
            background-color: #f4f4f4;
            display: flex;
            justify-content: center;
            align-items: center;
            flex-direction: column;
        }

        .halaman {
			width: 210mm;         /* Lebar kertas F4 */
			height: 334mm;        /* Tinggi kertas F4 */
            margin-top: 10px;
			margin-bottom: 10px;
			margin-left: 20px;
			margin-right: 10px;
            background: white;
            box-shadow: 0 0 10px rgba(0, 0, 0, 0.2);
            padding-top: 15mm;
			padding-bottom: 15mm;
			padding-left: 20px;
			padding-right: 0;
            box-sizing: border-box;
            position: relative;
            display: block;
			
        }

        @media screen {
            .halaman {
                margin-bottom: 40px;
            }
        }

        @media print {
    body {
        background: white;
        margin: 0;
        padding: 0;
    }
    .halaman {
        width: 210mm;
        height: 334mm;
		margin-top: 10px;
		margin-bottom: 10px;
		margin-left: 20px;
		margin-right: 15px;
        padding-top: 15mm;
		padding-bottom: 15mm;
		padding-left: 10px;
		padding-right: 0;
        box-shadow: none;
        page-break-after: always;
		
    }
    .halaman:last-child {
        page-break-after: avoid;
    }
    @page {
        size: 210mm 334mm; /* Ukuran F4 */
        margin: 0;
    }
            textarea {
                border: none !important;
                background: transparent;
                resize: none;
                padding: 0;
                line-height: 1.6;
                overflow: hidden;
                height: auto;
                width: auto;
            }
            table, th, td{
                border: none !important;
            }
			#H1_6 {
				border: none !important;
				background: transparent !important;
				padding: 0 !important;
				}
				.nama {
				border: none !important;
				background: transparent !important;
				padding: 0 !important;
				}
			#btnH18Popup {
				display: none !important;
				}
			#kontrolH18,
			#kontrolH110,
			#kontrolcalon,
			#Label-JUDUL{
				display: none !important;
			  }
			  
	
        }                                                                /* batas media print */

       

        /* Judul Surat */
        .judul-surat {
            text-align: center;
            margin: 20px 0;
        }

        .judul-surat h3 {
            font-size: 13pt;
            text-decoration: underline;
            text-underline-offset: 5px;
            margin: 0;
        }

        .judul-surat textarea {
            font-size: 12pt;
            text-align: center;
            margin: 5px 0;
            border: 1px solid #ccc;
            border-radius: 4px;
            padding: 4px;
            resize: none;
        }

        /* Isi Surat */
        .isi-surat {
            font-size: 12pt;
            line-height: 1.6;
            text-align: justify;
            margin-bottom: 20px;
        }

        /* Tabel */
        table.new-table {
            width: 100%;
            border-collapse: collapse;
            margin: 20px 0;
        }

        table.new-table, th, td {
            border: 1px solid black;
        }

        th, td {
            padding: 8px;
            text-align: center;
            font-size: 12pt;
        }

        th {
            background-color: #f2f2f2;
            font-weight: bold;
        }

        td[contenteditable="true"] {
            cursor: text;
            border: 1px solid #ccc;
        }

        table.new-table td:nth-child(2), table.new-table td:nth-child(4) {
            text-align: left;
        }

        /* Textarea Styling */
        textarea {
            font-family: 'BookmanOldStyle', serif;
            font-size: 12pt;
            line-height: 1.6;
            border: 1px solid #ccc;
            border-radius: 4px;
            padding: 4px;
            resize: none;
            overflow: hidden;
        }

        textarea:focus {
            border-color: #007bff;
            outline: none;
        }

        /* Tanda Tangan */
        .tanda-tangan {
            margin-top: 40px;
            text-align: right;
        }

        .tanda-tangan p {
            font-size: 12pt;
            margin: 5px 0;
        }

        .tanda-tangan textarea {
            font-size: 12pt;
            font-weight: bold;
            text-decoration: underline;
            margin-top: 60px;
            width: 200px;
            height: 20px;
            border: 1px solid #ccc;
            border-radius: 4px;
            padding: 4px;
            resize: none;
        }

        /* Footer Halaman */
        .footer-halaman {
            position: absolute;
            bottom: 20mm;
            left: 20mm;
            right: 20mm;
            font-size: 10pt;
            text-align: center;
        }

        /* Header */
        header {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 45px;
            background-color: #43474a;
            color: white;
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 0 15px;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
            z-index: 1000;
        }

        .header-left, .header-tengah1, .header-right {
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .header-left {
            flex: 1;
            justify-content: flex-start;
            font-size: 28px;
            color: #00bbff;
        }

        .header-tengah1 {
            flex: 1;
            justify-content: center;
            transform: translateX(-40px);
        }

        .header-right {
            flex: 1;
            justify-content: flex-end;
            transform: translateX(-40px);
        }

        .ico1, .ico2, .ico3, .ico4, .ico5, .btn-line {
            width: 30px;
            height: 30px;
            cursor: pointer;
            transition: transform 0.3s ease, opacity 0.3s ease;
        }

        .ico1:hover, .ico2:hover, .ico3:hover, .ico4:hover, .ico5:hover {
            transform: scale(1.2);
            opacity: 0.6;
        }

        .container3 button {
            padding: 3px 9px;
            font-size: 12px;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            background-color: #2bd937;
            color: black;
            transition: background-color 0.3s ease, transform 0.3s ease;
        }

        .container3 button:hover {
            background-color: #0aa614;
            transform: scale(1.05);
        }

        .title {
            font-size: 21px;
            font-weight: bold;
            margin-left: 10px;
        }

        @media print {
            header, #tabelPenduduk, .icon-container, #popupNama, #popupForm, #popupInputDataBaru, #trashBin {
                display: none;
            }
        }

        /* Popup Styling */
#popupNama {
    position: absolute;
    display: none;
    min-width: 240px;
    max-width: 320px;
    background-color: #ffffff;
    border: 1px solid #ddd;
    border-radius: 10px;
    box-shadow: 0 8px 16px rgba(0,0,0,0.15);
    padding: 18px;
    font-family: 'BookmanOldStyle', serif;
    font-size: 11pt;
    animation: fadeIn 0.25s ease-out;
    z-index: 9999;
}

#popupNama h3 {
    margin-top: 0;
    font-size: 13pt;
    margin-bottom: 10px;
    color: #333;
    border-bottom: 1px solid #eee;
    padding-bottom: 5px;
}

#daftarNama {
    list-style: none;
    padding: 0;
    margin: 0;
    max-height: 200px;
    overflow-y: auto;
}

#daftarNama li {
    padding: 6px 10px;
    border-bottom: 1px solid #eee;
    cursor: pointer;
    transition: background 0.2s;
}

#daftarNama li:hover {
    background-color: #e4ffb8;
}

.button-container {
    margin-bottom: -38px; /* Jarak antara daftar nama dan tombol */

}

.button-container2 {
    text-align: right; /* Menggeser tombol ke kanan */
	padding: 8px 10px;
}

#popupNama button {
    padding: 8px 10px;
    font-size: 10pt;
    border: none;
    border-radius: 4px;
    color: white;
    cursor: pointer;
    transition: background 0.2s;
    height: auto;
    line-height: 14px;
    vertical-align: middle;
}
#popupNama button {
    background-color: #3498db;
margin-left: 12px;
}
#popupNama button:hover {
    background-color: #2980b9;
}
#button-container2 button {
    background-color: #a3a3a3; /* Warna merah untuk tombol batal */
margin-right: 8px;
}

#button-container2 button:hover {
    background-color: #9c8787; /* Warna hover merah lebih gelap */
}





#popupInputCalonPengantin {
            display: none;
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background-color: white;
            border: 1px solid #ddd;
            border-radius: 10px;
            box-shadow: 0 8px 16px rgba(0,0,0,0.15);
            padding: 20px;
            font-family: 'BookmanOldStyle', serif;
            font-size: 11pt;
            z-index: 10000;
            width: 500px;
            max-height: 80vh;
            overflow-y: auto;
        }

        #popupInputCalonPengantin h3 {
            margin-top: 0;
            font-size: 13pt;
            margin-bottom: 15px;
            color: #333;
            border-bottom: 1px solid #eee;
            padding-bottom: 8px;
        }

        #popupInputCalonPengantin .form-row {
            display: flex;
            gap: 20px;
            margin-bottom: 15px;
        }

        #popupInputCalonPengantin .form-column {
            flex: 1;
        }

        #popupInputCalonPengantin input {
            width: 100%;
            padding: 8px;
            margin-bottom: 10px;
            border: 1px solid #ccc;
            border-radius: 4px;
            font-size: 11pt;
            font-family: 'BookmanOldStyle', serif;
        }

        #popupInputCalonPengantin .form-buttons {
            text-align: right;
        }

        #popupInputCalonPengantin button {
            padding: 8px 16px;
            margin-left: 10px;
            font-size: 11pt;
            border: none;
            border-radius: 4px;
            cursor: pointer;
        }

        #popupInputCalonPengantin button:first-child {
            background-color: #e74c3c;
            color: white;
        }

        #popupInputCalonPengantin button:last-child {
            background-color: #3498db;
            color: white;
        }


		
		
		
		
        /* Trash Bin */
        #trashBin {
            display: none;
            width: 100px;
            height: 100px;
            background-image: url('https://cdn-icons-png.flaticon.com/512/3096/3096673.png');
            background-size: cover;
            background-position: center;
            position: fixed;
            bottom: 20px;
            right: 20px;
            z-index: 1000;
        }

        #trashBin.drag-over {
            border: 2px solid red;
            background-color: rgba(255, 0, 0, 0.2);
        }

       
        tr.draggable {
            cursor: move;
        }

        tr.dragging {
            background-color: rgba(0, 123, 255, 0.2);
            opacity: 0.7;
            border: 2px dashed #007bff;
        }

        tr.drop-target {
            border: 2px dashed green;
        }



/* page1 ===============================================================================*/
		
	/* Original CSS remains unchanged, adding new styles for the button */
        #popupManualInputOrtu button#toggleDeceasedMode {
            background-color: #f1c40f; /* Yellow for distinct visibility */
            color: black;
            margin-right: 10px;
        }
        #popupManualInputOrtu button#toggleDeceasedMode:hover {
            background-color: #d4ac0d; /* Darker yellow on hover */
        }
        #popupManualInputOrtu button#toggleDeceasedMode.deceased-active {
            background-color: #e74c3c; /* Red when mode is active */
        }
        #popupManualInputOrtu button#toggleDeceasedMode.deceased-active:hover {
            background-color: #c0392b; /* Darker red on hover */
        }	
		
		
		
		
#popupManualInputOrtu {
            display: none;
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background-color: white;
            border: 1px solid #ddd;
            border-radius: 10px;
            box-shadow: 0 8px 16px rgba(0,0,0,0.15);
            padding: 20px;
            font-family: 'BookmanOldStyle', serif;
            font-size: 11pt;
            z-index: 10001;
            width: 500px;
            max-height: 80vh;
            overflow-y: auto;
        }

        #popupManualInputOrtu h3 {
            margin-top: 0;
            font-size: 13pt;
            margin-bottom: 15px;
            color: #333;
            border-bottom: 1px solid #eee;
            padding-bottom: 8px;
        }

        #popupManualInputOrtu .form-row {
            display: flex;
            gap: 20px;
            margin-bottom: 15px;
        }

        #popupManualInputOrtu .form-column {
            flex: 1;
        }

        #popupManualInputOrtu input, #popupManualInputOrtu select {
            width: 100%;
            padding: 8px;
            margin-bottom: 10px;
            border: 1px solid #ccc;
            border-radius: 4px;
            font-size: 11pt;
            font-family: 'BookmanOldStyle', serif;
        }

        #popupManualInputOrtu .form-buttons {
            text-align: right;
        }

        #popupManualInputOrtu button {
            padding: 8px 16px;
            margin-left: 10px;
            font-size: 11pt;
            border: none;
            border-radius: 4px;
            cursor: pointer;
        }

        #popupManualInputOrtu button:first-child {
            background-color: #e74c3c;
            color: white;
        }

        #popupManualInputOrtu button:last-child {
            background-color: #3498db;
            color: white;
        }

        #popupManualInputOrtu button#toggleDeceasedMode {
            background-color: #f1c40f;
            color: black;
            margin-right: 10px;
        }

        #popupManualInputOrtu button#toggleDeceasedMode:hover {
            background-color: #d4ac0d;
        }

        #popupManualInputOrtu button#toggleDeceasedMode.deceased-active {
            background-color: #e74c3c;
        }

        #popupManualInputOrtu button#toggleDeceasedMode.deceased-active:hover {
            background-color: #c0392b;
        }

        #manualNamaKakek {
            display: none !important;
        }
		
	

 
		
		
		
#H1_1 {    
	margin-top: 0px;
	margin-left: 330px;    
	text-align: left;	
    font-size: 9pt;
    font-family: 'BookmanOldStyle', serif;
    width: 400px;
    height: 23px;
	letter-spacing: 12%;
	word-spacing: 0.24px;
	line-height: 1;
    border: none;
    outline: none;
	}

 /* Kop Surat */
        .kop-surat {
            text-align: center;
            margin-bottom: 20px;
        }
        .kop-surat h1 {     
            font-size: 12pt;
            margin: 2px 0;
			margin-top: 20px;
            text-transform: uppercase;
			font-family: 'bookmanoldstyle_bold', serif;
			}
        .kop-surat h2 {
			font-size: 12pt;
            margin: 3px 0;
			text-align: right;
			 margin-right: 0;		
			font-family: 'bookmanoldstyle_bold', serif;			 
			}
		.kop-surat h3 {     
            font-size: 12pt;
            margin: 2px 0;
			margin-top: 30px;
            text-transform: uppercase;
			text-decoration: underline;
		   text-underline-offset: 3px;
		   position: relative; /* aktifkan lapisan */
		  z-index: 10;        /* pastikan di atas elemen lain */
		  background: white;  /* opsional: untuk nutupi elemen di belakang */
		  font-family: 'bookmanoldstyle_bold', serif;
			}
		
		.kop-surat h4 {
			font-size: 12pt;
            margin: 3px 0;
			text-align: left;
			 margin-left: 0px;		
			 font-weight: normal;
			 letter-spacing: 0.1px;
			 line-height: 1.3;
			}
			
.page1_kantor {
	  display: flex;
	  gap: 1px;
	  justify-content: flex-start;
	  margin-left: 0;
	  padding-left: 0;
	  height: 59px; /* tinggi baris kontainer */
	}

		#H1_2, #H1_3 {
		height: 59px; /* tinggi masing-masing textarea */
			}
		#H1_4 {
		  height: 1px;
		}

.page1_NAMA {
	  display: flex;
	  gap: 0px;
	  justify-content: flex-start;
	  margin-left: 0;
	  padding-left: 15px;
	  padding-bottom: 10px;
	  height: 258px; /* tinggi baris kontainer */
	  letter-spacing: 0.1px;     /* Rapat tapi tetap terbaca */
	  word-spacing: 0.5px;
	  line-height: 1;          /* Hindari terlalu padat atau terlalu renggang */
		}
.page1_NAMAORTU {
	  display: flex;
	  gap: 0px;
	  justify-content: flex-start;
	  margin-left: 0;
	  padding-left: 15px;
	  padding-bottom: 12px;
	  height: 145px; /* tinggi baris kontainer */
	  margin-left: 0px;
	  letter-spacing: 0.1px;     /* Rapat tapi tetap terbaca */
	  word-spacing: 0.5px;
	  line-height: 1;          /* Hindari terlalu padat atau terlalu renggang */
		}
.page1_NAMAORTU2 {
	  display: flex;
	  gap: 0px;
	  justify-content: flex-start;
	  margin-left: 0;
	  padding-top: 4px;
	  padding-left: 15px;
	  padding-bottom: 45px;
	  height: 139px; /* tinggi baris kontainer */
	  margin-left: 0px;
	  letter-spacing: 0.1px;     /* Rapat tapi tetap terbaca */
	  word-spacing: 0.5px;
	  line-height: 1;          /* Hindari terlalu padat atau terlalu renggang */
		}
.page1_TDD {
	  display: flex;
	  gap: 0px;
	  justify-content: flex-end;
	  margin-: 0;
	  padding-bottom: 0px;
	  padding-top: 23px;
	  height: 135px; /* tinggi baris kontainer */
	  margin-left: 0px;
	  letter-spacing: 0.1px;     /* Rapat tapi tetap terbaca */
	  word-spacing: 0.5px;
	  line-height: 1;          /* Hindari terlalu padat atau terlalu renggang */
		}
	
	#H1_2 .baris {
	  display: flex;
	  text-align: left;
	  justify-content: space-between;
	  width: 358px;
	  font-family: 'BookmanOldStyle', serif;
	  letter-spacing: 0.3px;     /* Rapat tapi tetap terbaca */
	  word-spacing: 0.5px;
	  line-height: 1.2;          /* Hindari terlalu padat atau terlalu renggang */
	}
		#H1_2 {
		  width: 225px;
		  font-family: 'BookmanOldStyle', serif;
		  font-size: 12pt;
		  line-height: 1.3;
		  letter-spacing: -0.70px;     /* Rapat tapi tetap terbaca */
		  word-spacing: 0.5px;

		}
		#H1_3 {
		  width: 60%;
		  font-family: 'BookmanOldStyle', serif;
		  font-size: 12pt;
		  line-height: 1.3;
		  letter-spacing: 0.1px;     /* Rapat tapi tetap terbaca */
		  word-spacing: 0.5px;
		}
		#H1_4 {
		  width: 300px;
		  font-family: 'BookmanOldStyle', serif;
		  font-size: 12pt;
		  line-height: 1.3;
		  letter-spacing: 0.1px;     /* Rapat tapi tetap terbaca */
		  word-spacing: 0.5px;
		  text-align: center;
		  margin-top: -5px;
		}
		#H1_5 {
		  width: 300px;
		  font-family: 'BookmanOldStyle', serif;
		  font-size: 12pt;
		  line-height: 1.2;
		  letter-spacing: -0.30px;     /* Rapat tapi tetap terbaca */
		  word-spacing: 0.5px;
		}
		#H1_6 {
		  width: 440px;
		  height: 259px;
		  font-family: 'BookmanOldStyle', serif;
		  font-size: 12pt;
		  line-height: 1.2;
		  letter-spacing: -0.10px;
		  word-spacing: 0.5px;
		  text-align: left;	  
		  border: 1px solid #ccc;
		  padding-top: 3px !important;
		  min-height: 60px;
		  white-space: pre-wrap;
		  outline: none;
		}
		.hanging-indent {
		  display: block;
		  padding-left: 7px;       /* sejajarkan isi setelah ": " */
		  text-indent: -7px;       /* tarik baris pertama sejajar dengan ":" */
		  text-align: left;
		  white-space: normal;
		}
		#H1_7 {
		  width: 300px;
		  font-family: 'BookmanOldStyle', serif;
		  font-size: 12pt;
		  line-height: 1.2;
		  letter-spacing: -0.30px;     /* Rapat tapi tetap terbaca */
		  word-spacing: 0.5px;
		}
		#H1_8 {                   /* PAGE1_ORTU1 ": " */
		  width: 440px;
		  font-family: 'BookmanOldStyle', serif;
		  font-size: 12pt;
		  line-height: 1.2;
		  letter-spacing: 0.1px;
		  word-spacing: 0.5px;
		  text-align: left;
		  height: 150px;
		  border: 1px solid #ccc;
		  padding-top: 3px !important;
		  padding-bottom: 7px;
		  min-height: 60px;
		  white-space: pre-wrap;
		  outline: none;
		}
		.hanging-indent {
		  display: block;
		  padding-left: 7px;       /* sejajarkan isi setelah ": " */
		  text-indent: -7px;       /* tarik baris pertama sejajar dengan ":" */
		  text-align: left;
		  white-space: normal;
		}
		#H1_9 {
		  width: 300px;
		  font-family: 'BookmanOldStyle', serif;
		  font-size: 12pt;
		  line-height: 1.2;
		  letter-spacing: -0.30px;     /* Rapat tapi tetap terbaca */
		  word-spacing: 0.5px;
		}
		#H1_10 {                   /* PAGE1_ORTU1 ": " */
		  width: 440px;
		  font-family: 'BookmanOldStyle', serif;
		  font-size: 12pt;
		  line-height: 1.2;
		  letter-spacing: 0.1px;
		  word-spacing: 0.5px;
		  text-align: left;
		  height: 155px;
		  border: 1px solid #ccc;
		  padding-top: 3px !important;
		  min-height: 60px;
		  white-space: pre-wrap;
		  outline: none;
		  text-align: justify;
		}
		.hanging-indent {
		  display: block;
		  padding-left: 13px;       /* sejajarkan isi setelah ": " */
		  text-indent: -13px;       /* tarik baris pertama sejajar dengan ":" */
		  text-align: left;
		  white-space: normal;
		}
	#H1_11 {                   /* PAGE1_ORTU1 ": " */
		  width: 350px;
		  font-family: 'BookmanOldStyle', serif;
		  font-size: 12pt;
		  line-height: 1.2;
		  letter-spacing: 0.1px;
		  word-spacing: 0.5px;
		  text-align: left;
		  height: 140px;
		  border: 1px solid #ccc;
		  padding: 4px;
		  min-height: 60px;
		  overflow-y: auto;
		  white-space: pre-wrap;
		  outline: none;
		}
		.hanging-indent {
		  display: block;
		  padding-left: 13px;       /* sejajarkan isi setelah ": " */
		  text-indent: -13px;       /* tarik baris pertama sejajar dengan ":" */
		  text-align: left;
		  white-space: normal;
		}

#btnH18Popup,
#btnH110Popup {
  padding: 8px 14px;
  width: 170px;
  font-size: 12px;
  background-color: #91908d;
  color: white;
  border: none;
  border-radius: 4px;
  cursor: pointer;
  box-shadow: 1px 1px 4px rgba(0,0,0,0.2);
}


#btnInputCalonPengantin {
  padding: 8px 14px;
  width: 170px;
  font-size: 12px;
  background-color: #91908d;
  color: white;
  border: none;
  border-radius: 4px;
  cursor: pointer;
  box-shadow: 1px 1px 4px rgba(0,0,0,0.2);
}

@keyframes fadeIn {
  from {
    opacity: 0;
    transform: translateY(-5px);
  }
  to {
    opacity: 1;
    transform: translateY(0);
  }
}

#popupNama {
  animation: fadeIn 0.25s ease-out;
}

/* page2 ===============================================================================*/	
		
#H2_1 {    
	margin-top: 0px;
	margin-left: 330px;    
	text-align: left;	
    font-size: 9pt;
    font-family: 'BookmanOldStyle', serif;
    width: 400px;
    height: 23px;
	letter-spacing: 12%;
	word-spacing: 0.24px;
	line-height: 1.1;
    border: none;
    outline: none;
	}


.perihal{    
	margin-top: 0px;
	margin-left: 0px;    
	text-align: left;	
    font-family: 'BookmanOldStyle', serif;
		  font-size: 13pt !important;
		  line-height: 1.3 !important;
		  letter-spacing: -0.70px !important;
		  word-spacing: 0.5px;

	}
	
	
	
/* PAGE2-kop-surat */
        .PAGE2-kop-surat {
            text-align: center;
			margin-top: 50px;
			margin-bottom: 30px;
        }
        .PAGE2-kop-surat h5 {     
            font-family: bookmanoldstyle_bold, serif;
		  font-size: 13pt !important;
		  line-height: 1.3 !important;
		  letter-spacing: -0.70px !important;
		  word-spacing: 0.5px;
            margin: 2px 0;
			margin-top: 20px;
            text-transform: uppercase;

			}
        .PAGE2-kop-surat h6 {
			font-family: bookmanoldstyle_bold, serif;
		  font-size: 13pt !important;
		  line-height: 1.3 !important;
		  letter-spacing: -0.70px !important;
		  word-spacing: 0.5px;
            margin: 3px 0;
			text-align: right;
			 margin-right: 0;		
		 
			}
		.PAGE2-kop-surat h7 {     
            font-family: 'BookmanOldStyle', serif;
		  font-size: 13pt !important;
		  line-height: 1.3 !important;
		  letter-spacing: -0.70px !important;
		  word-spacing: 0.5px;
            margin: 2px 0;
			margin-top: 30px;
            text-transform: uppercase;
			text-decoration: underline;
		   text-underline-offset: 3px;
		   position: relative; /* aktifkan lapisan */
		  z-index: 10;        /* pastikan di atas elemen lain */
		  background: white;  /* opsional: untuk nutupi elemen di belakang */

			}
		
		.PAGE2-kop-surat h8 {
			font-family: 'BookmanOldStyle', serif;
		  font-size: 13pt !important;
		  line-height: 1.3 !important;
		  letter-spacing: -0.70px !important;
		  word-spacing: 0.5px;
            margin: 3px 0;
			text-align: left;
			 margin-left: 0px;		
			
			 margin-top: 80px;
			}	
			
			
	#H2_3 {
	  width: 60%;
	   font-family: 'BookmanOldStyle', serif;
		  font-size: 13pt !important;
		  line-height: 1.3 !important;
		  letter-spacing: -0.70px !important;
		  word-spacing: 0.5px;
	  justify-content: flex-end;
	  padding-top:-15px;
	}
	
h8-1 {
  display: block;       /* wajib agar bisa pakai margin */
  margin-top: 30px;
 font-family: 'BookmanOldStyle', serif;
		  font-size: 13pt !important;
		  line-height: 1.3 !important;
		  letter-spacing: -0.70px !important;
		  word-spacing: 0.5px;
}

	
.page2-yth {
  display: flex;
  width: max-content;
  max-width: 100%;
  padding-right: 20px;
  margin-left: auto;
  margin-right: 15px;
  margin-bottom: 45px;
  overflow-wrap: break-word;
  word-break: break-word;
  box-sizing: border-box;
  white-space: nowrap;
}


  
h7 {
  display: block;       /* wajib agar bisa pakai margin */
  margin-top: 30px;
 font-family: 'BookmanOldStyle', serif;
		  font-size: 13pt !important;
		  line-height: 1.3 !important;
		  letter-spacing: -0.70px !important;
		  word-spacing: 0.5px;
}

.page2_sutri {
	  display: flex;
	  gap: 0px;
	  justify-content: flex-start;
	  margin-left: 0;
	  padding-top: 4px;
	  padding-left: 15px;
	  padding-bottom: 25px;
	  height: 115px; /* tinggi baris kontainer */
	  margin-left: 0px;
	  font-family: 'BookmanOldStyle', serif;
		  font-size: 13pt !important;
		  line-height: 1.3 !important;
		  letter-spacing: -0.70px !important;
		  word-spacing: 0.5px;
		}
.page2_permohonan {
	  display: flex;
	  gap: 0px;
	  justify-content: flex-start;
	  margin-left: 0;
	  padding-top: 4px;
	  padding-left: 17px;
	  padding-bottom: 10px;
	  height: 290px; /* tinggi baris kontainer */
	  margin-left: 0px;

		}
		
	#H2_4 {
		  width: 190px;
		  height: 115px;
		  font-family: 'BookmanOldStyle', serif;
		  font-size: 13pt !important;
		  line-height: 1.3 !important;
		  letter-spacing: -0.70px !important;
		  word-spacing: 0.5px;
		}	
	#H2_5 { 
		width: 440px;
		  font-family: 'BookmanOldStyle', serif;
		  font-size: 13pt !important;
		  line-height: 1.3 !important;
		  letter-spacing: -0.70px !important;
		  word-spacing: 0.5px;
		  text-align: left;
		  height: 115px;
		  border: 1px solid #ccc;
		  padding-top: 3px !important;
		  padding-bottom: 7px;
		  min-height: 60px;
		  white-space: pre-wrap;
		  outline: none;
		}
		.hanging-indent {
		  display: block;
		  padding-left: 7px;       /* sejajarkan isi setelah ": " */
		  text-indent: -7px;       /* tarik baris pertama sejajar dengan ":" */
		  text-align: left;
		  white-space: normal;
		  }
	#H2_6 {
		 width: 30px;
		  height: 400px;
		  font-family: 'BookmanOldStyle', serif;
		  font-size: 13pt !important;
		  line-height: 1.3 !important;
		  letter-spacing: -0.70px !important;
		  word-spacing: 0.5px;
		}	

	
	#H2_7 { 
		width: 100%;
		  font-family: 'BookmanOldStyle', serif;
		  font-size: 13pt !important;
		  line-height: 1.3 !important;
		  letter-spacing: -0.70px !important;
		  word-spacing: 0.5px;
		  text-align: left;
		  height: 290px;
		  border: 1px solid #ccc;
		  padding-top: 3px !important;
		  padding-bottom: 7px;
		  min-height: 60px;
		  white-space: pre-wrap;
		  outline: none;
		}
		.hanging-indent {
		  display: block;
		  padding-left: 7px;       /* sejajarkan isi setelah ": " */
		  text-indent: -7px;       /* tarik baris pertama sejajar dengan ":" */
		  text-align: left;
		  white-space: normal;		
			}	

h9 {
  display: block;       /* wajib agar bisa pakai margin */
  margin-top: 6px;
  font-family: 'BookmanOldStyle', serif;
		  font-size: 13pt !important;
		  line-height: 1.3 !important;
		  letter-spacing: -0.70px !important;
		  word-spacing: 0.5px;
}




.page2_TDD-wrapper {
    display: flex;
    justify-content: space-between;
    align-items: flex-start;
    padding: 0 20px;
    gap: 20px;
    width: 100%;
    margin-top: 50px;

}

.page2_TTD {
    display: flex;
    flex-direction: column;
    align-items: flex-end;
    width: 40%; /* Batasi lebar untuk sisi kanan */
    text-align: right;
}

.page2_TTD2 {
    display: flex;
  width: max-content;
  max-width: 100%;
  padding-right: 20px;
  margin-left: auto;
  margin-right: 30px;
  overflow-wrap: break-word;
  word-break: break-word;
  box-sizing: border-box;
  white-space: nowrap;
		#H2_9 {                   /* PAGE1_ORTU1 ": " */
		  width: 540px;
		  font-family: 'BookmanOldStyle', serif;
		  font-size: 13pt !important;
		  line-height: 1.3 !important;
		  letter-spacing: -0.70px !important;
		  word-spacing: 0.5px;
		  text-align: left;
		  height: 155px;
		  border: 1px solid #ccc;
		  padding-top: 3px !important;
		  min-height: 60px;
		  white-space: pre-wrap;
		  outline: none;
		  text-align: justify;
		}
		
}

.page2_TTD div, .page2_TTD2 div {
    width: 100%;
    max-width: 300px; /* Batasi lebar konten */
    font-family: 'BookmanOldStyle', serif;
		  font-size: 13pt !important;
		  line-height: 1.3 !important;
		  letter-spacing: -0.70px !important;
		  word-spacing: 0.5px;
    border: 1px solid #ccc;
    padding: 4px;
    min-height: 120px;
    white-space: normal; /* Izinkan pembungkusan teks */
    overflow-x: auto;
    overflow-y: auto;
    outline: none;
    text-align: justify;
}

@media print {
    .page2_TDD-wrapper {
        padding: 0 10mm;
    }
}
/* page3 ===============================================================================*/	
		
#H3_1 {    
margin-top: 0px;
	margin-left: 330px;    
	text-align: left;	
    font-size: 9pt;
    font-family: 'BookmanOldStyle', serif;
    width: 400px;
    height: 23px;
	letter-spacing: 12%;
	word-spacing: 0.24px;
	line-height: 1.1;
    border: none;
    outline: none;
	}


.perihal3{    
	margin-top: 0px;
	margin-left: 0px;    
	margin-bottom: -2px;   
	text-align: left;	
    font-family: 'BookmanOldStyle', serif;
	  font-size: 13pt !important;
	  line-height: 1.5 !important;
	  letter-spacing: -0.70px !important;
	  word-spacing: 0.5px;

	}
	
.PAGE3-kop-surat {
            text-align: center;
			margin-top: 50px;
			margin-bottom: 30px;
        }
		.PAGE3-kop-surat h5 {     
            font-family: bookmanoldstyle_bold, serif;
		  font-size: 13pt !important;
		  line-height: 1.3 !important;
		  letter-spacing: -0.70px !important;
		  word-spacing: 0.5px;
            margin: 2px 0;
			margin-top: 20px;
            text-transform: uppercase;

			}
        .PAGE3-kop-surat h6 {
			font-family: bookmanoldstyle_bold, serif;
		  font-size: 13pt !important;
		  line-height: 1.3 !important;
		  letter-spacing: -0.70px !important;
		  word-spacing: 0.5px;
            margin: 3px 0;
			text-align: right;
			 margin-right: 0;		
		 
			}
		.PAGE3-kop-surat h7 {     
            font-family: 'BookmanOldStyle', serif;
		  font-size: 13pt !important;
		  line-height: 1.3 !important;
		  letter-spacing: -0.70px !important;
		  word-spacing: 0.5px;
            margin: 2px 0;
			margin-top: 30px;
            text-transform: uppercase;
			text-decoration: underline;
		   text-underline-offset: 3px;
		   position: relative; /* aktifkan lapisan */
		  z-index: 10;        /* pastikan di atas elemen lain */
		  background: white;  /* opsional: untuk nutupi elemen di belakang */

			}
		
		.PAGE3-kop-surat h8 {
			font-family: 'BookmanOldStyle', serif;
		  font-size: 13pt !important;
		  line-height: 1.3 !important;
		  letter-spacing: -0.70px !important;
		  word-spacing: 0.5px;
            margin: 3px 0;
			text-align: left;
			 margin-left: 0px;		
			
			 margin-top: 80px;
			}	

.page3_NAMA {
	  display: flex;
	  gap: 0px;
	  justify-content: flex-start;
	  margin-left: 0;
	  padding-left: 15px;
	  padding-bottom: 25px;
	  height: 200px; /* tinggi baris kontainer */
	  letter-spacing: 0.1px;     /* Rapat tapi tetap terbaca */
	  word-spacing: 0.5px;
	  line-height: 1;          /* Hindari terlalu padat atau terlalu renggang */
		}
	#H3_5 {
		  width: 300px;
		  font-family: 'BookmanOldStyle', serif;
		  font-size: 12pt;
		  line-height: 1.2;
		  letter-spacing: -0.30px;     /* Rapat tapi tetap terbaca */
		  word-spacing: 0.5px;
		}
		#H3_6 {
		  width: 440px;
		  height: 259px;
		  font-family: 'BookmanOldStyle', serif;
		  font-size: 12pt;
		  line-height: 1.2;
		  letter-spacing: -0.10px;
		  word-spacing: 0.5px;
		  text-align: left;	  
		  border: 1px solid #ccc;
		  padding-top: 3px !important;
		  min-height: 60px;
		  white-space: pre-wrap;
		  outline: none;
		}
		.hanging-indent {
		  display: block;
		  padding-left: 7px;       /* sejajarkan isi setelah ": " */
		  text-indent: -7px;       /* tarik baris pertama sejajar dengan ":" */
		  text-align: left;
		  white-space: normal;
		}

		#H3_5 {
		  width: 300px;
		  font-family: 'BookmanOldStyle', serif;
		  font-size: 13pt !important;
		  line-height: 1.3 !important;
		  letter-spacing: -0.85px !important;
		  word-spacing: 0.5px;
		}
		#H3_6 {
		  width: 440px;
		  height: 220px;
		  font-family: 'BookmanOldStyle', serif;
		  font-size: 13pt !important;
		  line-height: 1.3 !important;
		  letter-spacing: -0.70px !important;
		  word-spacing: 0.5px;
		  text-align: left;	  
		  border: 1px solid #ccc;
		  padding-top: 3px !important;
		  min-height: 60px;
		  white-space: pre-wrap;
		  outline: none;
		}
		.hanging-indent {
		  display: block;
		  padding-left: 7px;       /* sejajarkan isi setelah ": " */
		  text-indent: -7px;       /* tarik baris pertama sejajar dengan ":" */
		  text-align: left;
		  white-space: normal;
		}
	
	.page3_NAMA2 {
	  display: flex;
	  gap: 0px;
	  justify-content: flex-start;
	  margin-left: 0;
	  padding-left: 15px;
	  padding-bottom: 33px;
	  height: 200px; /* tinggi baris kontainer */
	  letter-spacing: 0.1px;     /* Rapat tapi tetap terbaca */
	  word-spacing: 0.5px;
	  line-height: 1;          /* Hindari terlalu padat atau terlalu renggang */
		}
		#H3_7 {
		  width: 300px;
		  font-family: 'BookmanOldStyle', serif;
		  font-size: 13pt !important;
		  line-height: 1.3 !important;
		  letter-spacing: -0.85px !important;
		  word-spacing: 0.5px;
		}
		#H3_8 {
		  width: 440px;
		  height: 220px;
		  font-family: 'BookmanOldStyle', serif;
		  font-size: 13pt !important;
		  line-height: 1.3 !important;
		  letter-spacing: -0.70px !important;
		  word-spacing: 0.5px;
		  text-align: left;	  
		  border: 1px solid #ccc;
		  padding-top: 3px !important;
		  min-height: 60px;
		  white-space: pre-wrap;
		  outline: none;
		}
		.hanging-indent {
		  display: block;
		  padding-left: 7px;       /* sejajarkan isi setelah ": " */
		  text-indent: -7px;       /* tarik baris pertama sejajar dengan ":" */
		  text-align: left;
		  white-space: normal;
		}
		

.page3_TDD-wrapper {
    display: flex;
    justify-content: space-between;
    align-items: flex-start;
    padding: 0 20px;
    gap: 20px;
    width: 100%;
    margin-top: 50px;

}

.page3_TTD {
    display: flex;
    flex-direction: column;
    align-items: flex-end;
    width: 40%; /* Batasi lebar untuk sisi kanan */
    text-align: right;
}

.page3_TTD2 {
    display: flex;
  width: max-content;
  max-width: 100%;
  padding-right: 20px;
  margin-left: auto;
  margin-right: 30px;
  overflow-wrap: break-word;
  word-break: break-word;
  box-sizing: border-box;
  white-space: nowrap;
  }
		#H3_9 {                   /* PAGE1_ORTU1 ": " */
		  width: 540px;
		  font-family: 'BookmanOldStyle', serif;
		  font-size: 13pt !important;
		  line-height: 1.3 !important;
		  letter-spacing: -0.70px !important;
		  word-spacing: 0.5px;
		  height: 155px;
		  border: 1px solid #ccc;
		  padding-top: 3px !important;
		  min-height: 60px;
		  white-space: pre-wrap;
		  outline: none;
		  text-align: center;
		}
		#H3_10 {                   /* PAGE1_ORTU1 ": " */
		  width: auto;
		  font-family: 'BookmanOldStyle', serif;
		  font-size: 13pt !important;
		  line-height: 1.3 !important;
		  letter-spacing: -0.70px !important;
		  word-spacing: 0.5px;
		  height: 155px;
		  border: 1px solid #ccc;
		  padding-top: 3px !important;
		  min-height: 60px;
		  white-space: pre-wrap;
		  outline: none;
		  text-align: center;
		}


.page3_TTD div, .page3_TTD2 div {
    width: 100%;
    max-width: 300px; /* Batasi lebar konten */
    font-family: 'BookmanOldStyle', serif;
		  font-size: 13pt !important;
		  line-height: 1.3 !important;
		  letter-spacing: -0.70px !important;
		  word-spacing: 0.5px;
    border: 1px solid #ccc;
    padding: 4px;
    min-height: 120px;
    white-space: normal; /* Izinkan pembungkusan teks */
    overflow-x: auto;
    overflow-y: auto;
    outline: none;
    text-align: justify;
}

@media print {
    .page3_TDD-wrapper {
        padding: 0 10mm;
    }
}


/* page4 ===============================================================================*/	
		
#H4_1 {    
margin-top: 0px;
	margin-left: 330px;    
	text-align: left;	
    font-size: 9pt;
    font-family: 'BookmanOldStyle', serif;
    width: 400px;
    height: 23px;
	letter-spacing: 12%;
	word-spacing: 0.24px;
	line-height: 1;
    border: none;
    outline: none;
	}


.perihal4{    
	margin-top: 0px;
	margin-left: 0px;    
	margin-bottom: 2px;   
	text-align: left;	
    font-family: 'BookmanOldStyle', serif;
	  font-size: 13pt !important;
	  line-height: 1.5 !important;
	  letter-spacing: -0.70px !important;
	  word-spacing: 0.5px;

	}
	
.PAGE4-kop-surat {
            text-align: center;
			margin-top: -2px;
			margin-bottom: -8px;
        }
		.PAGE4-kop-surat h5 {     
            font-family: bookmanoldstyle_bold, serif;
		  font-size: 13pt !important;
		  line-height: 1.3 !important;
		  letter-spacing: -0.70px !important;
		  word-spacing: 0.5px;
            margin: 2px 0;
			margin-top: 20px;
            text-transform: uppercase;

			}
        .PAGE4-kop-surat h6 {
			font-family: bookmanoldstyle_bold, serif;
		  font-size: 13pt !important;
		  line-height: 1.3 !important;
		  letter-spacing: -0.70px !important;
		  word-spacing: 0.5px;
            margin: 3px 0;
			text-align: right;
			 margin-right: 0;		
		 
			}
		.PAGE4-kop-surat h7 {     
            font-family: 'BookmanOldStyle', serif;
		  font-size: 13pt !important;
		  line-height: 1.3 !important;
		  letter-spacing: -0.70px !important;
		  word-spacing: 0.5px;
            margin: 2px 0;
			margin-top: 30px;
            text-transform: uppercase;
			text-decoration: underline;
		   text-underline-offset: 3px;
		   position: relative; /* aktifkan lapisan */
		  z-index: 10;        /* pastikan di atas elemen lain */
		  background: white;  /* opsional: untuk nutupi elemen di belakang */

			}
		
		.PAGE4-kop-surat h8 {
			font-family: 'BookmanOldStyle', serif;
		  font-size: 13pt !important;
		  line-height: 1.3 !important;
		  letter-spacing: -0.70px !important;
		  word-spacing: 0.5px;
            margin: 3px 0;
			text-align: left;
			 margin-left: 0px;		
			
			 margin-top: 80px;
			}		
	
	.page4_nama_ayah, .page4_nama_ibu {
    display: flex;
    gap: 0px;
    justify-content: flex-start;
    margin-left: 0;
    padding-left: 15px;
    padding-bottom: 12px;
    height: 150px;
    letter-spacing: 0.1px;
    word-spacing: 0.5px;
    line-height: 1;
}

#H4_7, #H4_9 {
    width: 300px;
    font-family: 'BookmanOldStyle', serif;
    font-size: 12pt;
    line-height: 1.2;
    letter-spacing: -0.30px;
    word-spacing: 0.5px;
}

#H4_8, #H4_10 {
    width: 440px;
    font-family: 'BookmanOldStyle', serif;
    font-size: 12pt;
    line-height: 1.2;
    letter-spacing: 0.1px;
    word-spacing: 0.5px;
    text-align: left;
    height: 180px;
    border: 1px solid #ccc;
    padding-top: 3px;
    min-height: 60px;
    white-space: pre-wrap;
    outline: none;
}
	
#H4_5 {
		  width: 300px;
		  font-family: 'BookmanOldStyle', serif;
		  font-size: 12pt;
		  line-height: 1.2;
		  letter-spacing: -0.30px;     /* Rapat tapi tetap terbaca */
		  word-spacing: 0.5px;
		}
		

.page4_NAMA {
	  display: flex;
	  gap: 0px;
	  justify-content: flex-start;
	  margin-left: 0;
	  padding-top: 4px;
	  padding-left: 15px;
	  padding-bottom: 45px;
	  height: 158px; /* tinggi baris kontainer */
	  margin-left: 0px;
	  letter-spacing: 0.1px;     /* Rapat tapi tetap terbaca */
	  word-spacing: 0.5px;
	  line-height: 1;          /* Hindari terlalu padat atau terlalu renggang */
		}
#H4_6 {
		  width: 440px;
		  height: 188px;
		  font-family: 'BookmanOldStyle', serif;
		  font-size: 12pt;
		  line-height: 1.2;
		  letter-spacing: -0.10px;
		  word-spacing: 0.5px;
		  text-align: left;	  
		  border: 1px solid #ccc;
		  padding-top: 3px !important;
		  min-height: 60px;
		  white-space: pre-wrap;
		  outline: none;
		}
		.hanging-indent {
		  display: block;
		  padding-left: 7px;       /* sejajarkan isi setelah ": " */
		  text-indent: -7px;       /* tarik baris pertama sejajar dengan ":" */
		  text-align: left;
		  white-space: normal;
		}	
.page4_calon {
	  display: flex;
	  gap: 0px;
	  justify-content: flex-start;
	  margin-left: 0;
	  padding-top: 4px;
	  padding-left: 15px;
	  padding-bottom: 35px;
	  height: 158px; /* tinggi baris kontainer */
	  margin-left: 0px;
	  letter-spacing: 0.1px;     /* Rapat tapi tetap terbaca */
	  word-spacing: 0.5px;
	  line-height: 1;          /* Hindari terlalu padat atau terlalu renggang */
		}
		#H4_11 {
		  width: 300px;
		  font-family: 'BookmanOldStyle', serif;
		  font-size: 12pt;
		  line-height: 1.2;
		  letter-spacing: -0.30px;     /* Rapat tapi tetap terbaca */
		  word-spacing: 0.5px;
		}
	#H4_12 {
		  width: 440px;
		  height: 180px;
		  font-family: 'BookmanOldStyle', serif;
		  font-size: 12pt;
		  line-height: 1.2;
		  letter-spacing: -0.10px;
		  word-spacing: 0.5px;
		  text-align: left;	  
		  border: 1px solid #ccc;
		  padding-top: 3px !important;
		  min-height: 60px;
		  white-space: pre-wrap;
		  outline: none;
		}
		.hanging-indent {
		  display: block;
		  padding-left: 7px;       /* sejajarkan isi setelah ": " */
		  text-indent: -7px;       /* tarik baris pertama sejajar dengan ":" */
		  text-align: left;
		  white-space: normal;
		}		


.page4_NAMAORTU {
	  display: flex;
	  gap: 0px;
	  justify-content: flex-start;
	  margin-left: 0;
	  padding-left: 15px;
	  padding-bottom: 12px;
	  height: 176px; /* tinggi baris kontainer */
	  margin-left: 0px;
	  letter-spacing: 0.1px;     /* Rapat tapi tetap terbaca */
	  word-spacing: 0.5px;
	  line-height: 1;          /* Hindari terlalu padat atau terlalu renggang */
		}
		
		
		

.page4_TDD-wrapper {
    display: flex;
    justify-content: space-between;
    align-items: flex-start;
    padding: 0 20px;
    gap: 20px;
    width: 100%;
    margin-top: 20px;

}

.page4_TTD {
    display: flex;
    flex-direction: column;
    align-items: flex-end;
    width: 40%; /* Batasi lebar untuk sisi kanan */
    text-align: right;
}

.page4_TTD2 {
    display: flex;
  width: max-content;
  max-width: 100%;
  padding-right: 20px;
  margin-left: auto;
  margin-right: 30px;
  overflow-wrap: break-word;
  word-break: break-word;
  box-sizing: border-box;
  white-space: nowrap;
  }
		#H4_13 {                   /* PAGE1_ORTU1 ": " */
		  width: 300px;
		  font-family: 'BookmanOldStyle', serif;
		  font-size: 13pt !important;
		  line-height: 1.4 !important;
		  letter-spacing: -0.70px !important;
		  word-spacing: 0.5px;
		  text-align: center;
		  height: 155px;
		  border: 1px solid #ccc;
		  padding-top: 3px !important;
		  min-height: 60px;
		  white-space: pre-wrap;
		  outline: none;
		}
	#H4_14 {                   /* PAGE1_ORTU1 ": " */
		  width: auto;
		  font-family: 'BookmanOldStyle', serif;
		  font-size: 13pt !important;
		  line-height: 1.4 !important;
		  letter-spacing: -0.70px !important;
		  word-spacing: 0.5px;
		  text-align: center;
		  height: 155px;
		  border: 1px solid #ccc;
		  padding-top: 3px !important;
		  min-height: 60px;
		  white-space: pre-wrap;
		  outline: none;
		}	


.page4_TTD div, .page4_TTD2 div {
    width: 100%;
    max-width: 300px; /* Batasi lebar konten */
    font-family: 'BookmanOldStyle', serif;
		  font-size: 13pt !important;
		  line-height: 1.3 !important;
		  letter-spacing: -0.70px !important;
		  word-spacing: 0.5px;
    border: 1px solid #ccc;
    padding: 4px;
    min-height: 120px;
    white-space: normal; /* Izinkan pembungkusan teks */
    overflow-x: auto;
    overflow-y: auto;
    outline: none;
    text-align: justify;
}

@media print {
    .page4_TDD-wrapper {
        padding: 0 10mm;
    }
}


#btnH18Popup.disabled {
  pointer-events: none;     /* Mencegah klik */
  opacity: 0.5;             /* Menurunkan transparansi */
  cursor: not-allowed;      /* Ubah cursor jadi tanda dilarang */
}		
#btnH110Popup.disabled {
  pointer-events: none;     /* Mencegah klik */
  opacity: 0.5;             /* Menurunkan transparansi */
  cursor: not-allowed;      /* Ubah cursor jadi tanda dilarang */
}
#btnInputCalonPengantin.disabled {
  pointer-events: none;     /* Mencegah klik */
  opacity: 0.5;             /* Menurunkan transparansi */
  cursor: not-allowed;      /* Ubah cursor jadi tanda dilarang */
}



#popupManualInputOrtu button#toggleDeceasedMode {
    display: block;
    margin-left: 0;
    margin-right: auto;
}

    </style>
</head>
<body style="margin: 0;">
    <!-- Header -->
    <header>
        <div class="header-left">
            <img src="1/back.png" id="btn-back" alt="Kembali" class="ico3" width="30" height="30" style="cursor: pointer" onclick="goBack()">
            <span class="title">SURAT</span>
            <button id="deleteRowBtn" style="padding: 5px 10px; display:none;"></button>
        </div>
        <div class="header-tengah1">
		
				<iframe id="iframePenduduk" src="../data_penduduk.html" style="display:none; width:100%; height:500px; border:1px solid #ccc;"></iframe>

<!-- Tombol untuk membuka data penduduk -->
<button onclick="document.getElementById('iframeDataPenduduk').style.display='block'">Import Calon</button>




            <img src="1/line.png" id="btn-line" alt="Kembali" width="30" height="30">
            <img src="1/home.png" id="btn-home" class="ico1" alt="home" width="30" height="30" style="cursor: pointer" onclick="home()">
            <img src="1/database.png" id="btn-database" class="ico2" alt="Database" width="30" height="30" style="cursor: pointer" onclick="databasepage()">
            <img src="1/line.png" id="btn-line" alt="Kembali" width="30" height="30">
            <img src="1/reload.png" id="btn-reload" alt="Reload" class="ico4" width="30" height="30" style="cursor: pointer" onclick="reloadPage()">
            <img src="1/line.png" id="btn-line" alt="Kembali" width="30" height="30">
            <img src="1/print.png" id="btn-print" class="ico5" alt="Print" width="30" height="30" style="cursor: pointer" onclick="printPage()">
            <img src="1/line.png" id="btn-line" alt="Kembali" width="30" height="30">
        </div>
        <div class="header-right">
            <div class="container4">
                <img src="1/down.png" id="moveDown" class="ico5" alt="Geser Bawah" width="30" height="30" style="cursor: pointer">
                <img src="1/up.png" id="moveUp" class="ico5" alt="Geser Atas" width="30" height="30" style="cursor: pointer">
                <img src="1/left.png" id="moveLeft" class="ico5" alt="Geser Kiri" width="30" height="30" style="cursor: pointer">
                <img src="1/right.png" id="moveRight" class="ico5" alt="Geser Kanan" width="30" height="30" style="cursor: pointer">
            </div>
            <div class="container3">
                <img src="1/line.png" class="btn-line" alt="Kembali" width="30" height="30">
                <img src="1/move-up.png" id="scrollUp" class="ico5" alt="Tek Minus" width="30" height="30" style="cursor: pointer">
                <img src="1/move-down.png" id="scrollDown" class="ico5" alt="Tek Minus" width="30" height="30" style="cursor: pointer">
                <img src="1/line.png" id="btn-line" alt="Kembali" width="30" height="30">
                <img src="1/add.png" id="tombolTambahData" class="ico5" alt="Tek Minus" width="30" height="30" style="cursor: pointer">
                <img src="1/line.png" id="btn-line" alt="Kembali" width="30" height="30">
                <img src="1/teks-down.png" id="decreaseFont" class="ico5" alt="Tek Minus" width="30" height="30" style="cursor: pointer">
                <img src="1/teks-up.png" id="increaseFont" class="ico5" alt="Teks Up" width="30" height="30" style="cursor: pointer">
            </div>
        </div>
    </header>

    <!-- Tabel Penduduk -->
    <table id="tabelPenduduk" style="display: none;">
        <thead>
            <tr>
                <th>Kode</th>
                <th>KK</th>
                <th>NIK</th>
                <th>Nama</th>
                <th>Tempat Lahir</th>
                <th>Tanggal Lahir</th>
                <th>Status</th>
                <th>Gender</th>
                <th>Pekerjaan</th>
                <th>Alamat Dusun</th>
                <th>Desa</th>
            </tr>
        </thead>
        <tbody id="dataPendudukContainer"></tbody>
    </table>

    <!-- Trash Bin -->
    <div id="trashBin"></div>

      <!-- Halaman 1: Placeholder -->
    <div class="halaman">
	
	<textarea id="H1_1" rows="5" cols="1" placeholder="LAMPIRAN" ></textarea>
    <div class="kop-surat">
		<h1>FORMULIR  SURAT PENGANTAR NIKAH</h1>
		<h2>MODEL N-1</h2>
		
		<div class="page1_kantor">
			<textarea id="H1_2" rows="3" placeholder="KET KANTOR" ></textarea>
			<textarea id="H1_3" rows="3" placeholder="TITIK DUA dan KANTOR" ></textarea>
        </div>
		
		
<div id="Label-JUDUL" style="position: fixed; top: 70px; left: 20px; z-index: 9999;">
  <label class="labeljudul">UBAH DATA KELUARGA</label>
</div>		
		
		
<div id="kontrolH18" style="position: fixed; top: 100px; left: 20px; z-index: 9999;">
  <button id="btnH18Popup" onclick="bukaPopupH18()">1. Pilih AYAH Kandung</button>
  </label>
</div>


<div id="kontrolH110" style="position: fixed; top: 140px; left: 20px; z-index: 9999;">
  <button id="btnH110Popup" onclick="bukaPopupH110()">2. Pilih IBU Kandung&nbsp&nbsp&nbsp</button>
</div>

<div id="kontrolcalon" style="position: fixed; top: 180px; left: 20px; z-index: 9999;">
  <button id="btnInputCalonPengantin" onclick="bukaPopupCalonPengantin()">3. Calon Pengantin </button>
</div>




		<h3>FORMULIR PENGANTAR NIKAH</h3>
		<textarea id="H1_4" rows="1" placeholder="NOMOR" ></textarea>
		<h4>Yang bertanda tangan dibawah ini menerangkan dengan sesungguhnya bahwa :</h4>
		
		<div class="page1_NAMA">
			<textarea id="H1_5" rows="3" placeholder="KET NAMA" ></textarea>
			<div id="H1_6" rows="10" class="nama" placeholder="NAMA" ></div>
        </div>
		<h4>Adalah benar anak dari pernikahan seorang pria :</h4>
		
		<div class="page1_NAMAORTU">
			<textarea id="H1_7" rows="3" placeholder="KET NAMA" ></textarea>
			<div id="H1_8" rows="10" class="nama" placeholder="NAMA" ></div>
        </div>
		<h4>Dengan seorang wanita :</h4>
		<div class="page1_NAMAORTU2">
			<textarea id="H1_9" rows="3" placeholder="KET NAMA" ></textarea>
			<div id="H1_10" rows="10" class="nama" placeholder="NAMA" ></div>
        </div>
		<h4>Demikianlah surat pengantar ini dibuat dengan mengingat sumpah jabatan dan untuk <br> digunakan seperlunya.</h4>
		
	</div>  <!-- penutup  kop-surat -->
		
		<div class="page1_TDD">
			<div id="H1_11" rows="10" class="nama" placeholder="NAMA" ></div>
        </div>

<!-- Popup untuk Calon Pengantin (ditambahkan input Nama Bin, Ayah, dan Kakek) -->
<div id="popupInputCalonPengantin">
    <h3>Input Data Calon Pengantin</h3>
    <form id="formInputCalonPengantin">
        <div class="form-row">
            <div class="form-column">
                <label for="inputCalonNama" style="font-size: 10pt; color: #919191;">Nama Calon Pengantin</label>
                <input type="text" id="inputCalonNama" placeholder="Masukkan Nama Calon Pengantin" required>
                
                <label for="inputCalonBin" style="font-size: 10pt; color: #919191;">Nama Ayah</label>
                <input type="text" id="inputCalonBin" placeholder="Masukkan Nama Ayah" required>
                
                <label for="inputCalonNIK" style="font-size: 10pt; color: #919191;">NIK Calon Pengantin</label>
                <input type="text" id="inputCalonNIK" placeholder="Masukkan NIK Calon Pengantin" required>
                
                <label for="inputCalonTempatLahir" style="font-size: 10pt; color: #919191;">Tempat Lahir</label>
                <input type="text" id="inputCalonTempatLahir" placeholder="Masukkan Tempat Lahir" required>
                
                <label for="inputCalonTanggalLahir" style="font-size: 10pt; color: #919191;">Tanggal Lahir</label>
                <input type="text" id="inputCalonTanggalLahir" placeholder="dd/mm/yyyy" required>
            </div>
            <div class="form-column">
                <label for="inputCalonJenisKelamin" style="font-size: 10pt; color: #919191;">Jenis Kelamin</label>
                <input type="text" id="inputCalonJenisKelamin" placeholder="L/P" required>
                
                <label for="inputCalonPekerjaan" style="font-size: 10pt; color: #919191;">Pekerjaan</label>
                <input type="text" id="inputCalonPekerjaan" placeholder="Masukkan Pekerjaan" required>
                
                <label for="inputCalonAlamatDusun" style="font-size: 10pt; color: #919191;">Alamat Dusun</label>
                <input type="text" id="inputCalonAlamatDusun" placeholder="Masukkan Alamat Dusun" required>
                
                <label for="inputCalonDesa" style="font-size: 10pt; color: #919191;">Desa</label>
                <input type="text" id="inputCalonDesa" placeholder="Masukkan Nama Desa" required>
            </div>
        </div>
        <div class="form-buttons">
            <button type="button" onclick="tutupPopupCalonPengantin()">BATAL</button>
            <button type="button" onclick="simpanDataCalonPengantin()">SIMPAN</button>
        </div>
    </form>
</div>



 <div id="popupManualInputOrtu">
    <h3>Input Data Orang Tua Manual</h3>
    <div class="form-row">
        <div class="form-column">
            <input id="manualNamaOrtu" placeholder="Nama Lengkap" />
			<input type="text" id="manualNamaKakek" placeholder="Nama Kakek"> <!-- Field baru -->
            <input id="manualNIKOrtu" placeholder="NIK" />
            <input id="manualTempatLahirOrtu" placeholder="Tempat Lahir" />
            <select id="manualJenisKelaminOrtu">
                <option value="L">Laki-Laki</option>
                <option value="P">Perempuan</option>
            </select>
        </div>
        <div class="form-column">
            <input type="text" id="manualTanggalLahirOrtu" placeholder="dd/mm/yyyy (contoh: 06/05/2025)">
            <input id="manualPekerjaanOrtu" placeholder="Pekerjaan" />
            <input id="manualAlamatDusunOrtu" placeholder="Alamat Dusun" />
            <input id="manualDesaOrtu" placeholder="Desa" />
        </div>
    </div>
    <div class="form-buttons">

		<button id="toggleDeceasedMode" onclick="toggleDeceasedMode()">OFF</button>
		<label for="toggleDeceasedMode" style="font-size: 8pt; color: #919191;">Aktifkan Mode Meninggal</label>	
        <button onclick="tutupPopupManualInputOrtu()">Batal</button>
        <button onclick="simpanDataManualOrtu()">Simpan</button>
    </div>
</div>

		
		
		
		





		
		<div id="popupNama">
        <h3>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbspDATA ORANG TUA</h3>
		
		<div class="button-container" id="button-container">
        <ul id="daftarNama"></ul>
		</div>
		<div class="button-container2" id="button-container2">
        <button onclick="tutupPopup()">Tutup</button>
    </div>
	</div>
	
		
		
</div> 
<!-- -----------------End Halaman 2: Placeholder---------------------------------------- -->
    <div class="halaman">
  
<textarea id="H2_1" rows="5" cols="1" placeholder="LAMPIRAN" ></textarea>
  <div class="PAGE2-kop-surat">
		<h5>FORMULIR PERMOHONAN KEHENDAK PERKAWINAN</h5>
		<h6>MODEL N-2</h2>
  </div>
  <p class="perihal">Perihal &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;: Permohonan Kehendak Nikah</p>
   
   <div class="page2-yth">
		<div id="H2_3" rows="10" class="nama" placeholder="Kepada yth" ></div>
   </div>
   <p class="perihal">Dengan hormat, kami mengajukan permohonan kehendak nikah untuk atas nama :</p>
	<div class="page2_sutri">
			<textarea id="H2_4" rows="3" placeholder="KET NAMA" ></textarea>
			<div id="H2_5" rows="10" class="nama" placeholder="NAMA" ></div>
        </div>	
	<h9>Bersama ini kami sampaikan surat-surat yang diperlukan untuk diperiksa sebagai berikut:</h9>			
		<div class="page2_permohonan">
			<textarea id="H2_6" rows="3" placeholder="KET NAMA" ></textarea>
			<div id="H2_7" rows="10" class="nama" placeholder="NAMA" ></div>
        </div>	
	<h9>Demikian Permohonan ini kami sampaikan, kiranya dapat diperiksa, dihadiri, dan dicatat sesuai dengan ketentuan peraturan perundang-undangan.</h9>	
		<div class="page2_TDD-wrapper">
		<div class="page2_TTD">
			<div id="H2_9" rows="10" class="nama" placeholder="NAMA" ></div>
        </div>	
		<div class="page2_TTD2">
			<div id="H2_8" rows="10" class="nama" placeholder="NAMA" ></div>
        </div>	
		</div>	
    </div>  
	<!-- -----------------End Halaman 3: Placeholder---------------------------------------- -->

    <div class="halaman">

<textarea id="H3_1" rows="5" cols="1" placeholder="LAMPIRAN" ></textarea>
  <div class="PAGE3-kop-surat">
		<h5>FORMULIR SURAT PERSETUJUAN CALON PENGANTIN</h5>
		<h6>MODEL N-4</h2>
  </div>
   <p id="p3_1" class="perihal3">Yang bertanda tangan dibawah ini :<br>A.     Calon Suami</p>
<div class="page3_NAMA">
			<textarea id="H3_5" rows="3" placeholder="KET NAMA" ></textarea>
			<div id="H3_6" rows="10" class="nama" placeholder="NAMA" ></div>
        </div>
      <p id="p3_2" class="perihal3">B.     Calon Isteri</p>
<div class="page3_NAMA2">
			<textarea id="H3_7" rows="3" placeholder="KET NAMA" ></textarea>
			<div id="H3_8" rows="10" class="nama" placeholder="NAMA" ></div>
        </div>
<p class="perihal3">Menyatakan dengan sesungguhnya  bahwa atas dasar  sukarela,  dengan  kesadaran  sendiri,  tanpa  paksaan dari siapapun juga, setuju untuk melangsungkan pernikahan ini.<br><br>Demikian surat persetujuan ini di buat untuk dipergunakan seperlunya..
</p>

<div class="page3_TDD-wrapper">
		<div class="page3_TTD">
			<div id="H3_9" rows="10" class="nama" placeholder="NAMA" ></div>
        </div>	
		<div class="page3_TTD2">
			<div id="H3_10" rows="10" class="nama" placeholder="NAMA" ></div>
        </div>	
		</div>	
    </div>  


<!-- -----------------End Halaman 4: Placeholder---------------------------------------- -->

    <div class="halaman">

<textarea id="H4_1" rows="5" cols="1" placeholder="LAMPIRAN" ></textarea>
  <div class="PAGE4-kop-surat">
		<h5>FORMULIR SURAT IZIN ORANG TUA</h5>
		<h6>MODEL N-5</h2>
  </div>
<p class="perihal4">Yang bertanda tangan dibawah ini :</p>
<!-- Halaman 4 -->
<div class="page4_NAMAORTU">
    <textarea id="H4_7" rows="3" placeholder="KET NAMA AYAH"></textarea>
    <div id="H4_8" rows="10" class="nama" placeholder="NAMA AYAH"></div>
</div>
<div class="page4_NAMAORTU">
    <textarea id="H4_9" rows="3" placeholder="KET NAMA IBU"></textarea>
    <div id="H4_10" rows="10" class="nama" placeholder="NAMA IBU"></div>
</div>
<p class="perihal4">Adalah benar ayah dan ibu kandung/ wali/ Pengampun dari :</p>
<div class="page4_NAMAORTU">
			<textarea id="H4_5" rows="3" placeholder="KET NAMA" ></textarea>
			<div id="H4_6" rows="10" class="nama" placeholder="NAMA" ></div>
        </div>
<p class="perihal4">Memberikan Izin Kepada anak kami untuk melakukan pernikahan dengan :</p>
<div class="page4_calon">
			<textarea id="H4_11" rows="3" placeholder="KET NAMA" ></textarea>
			<div id="H4_12" rows="10" class="nama" placeholder="NAMA" ></div>
        </div>
<p class="perihal4">Demikian surat izin ini di buat dengan kesadaran tanpa ada paksaan dari Siapapun dan untuk digunakan seperlunya</p>

<div class="page4_TDD-wrapper">
		<div class="page4_TTD">
			<div id="H4_13" rows="10" class="nama" placeholder="NAMA" ></div>
        </div>	
		<div class="page4_TTD2">
			<div id="H4_14" rows="10" class="nama" placeholder="NAMA" ></div>
        </div>	
		</div>	
    </div>  









    <div class="halaman">

    </div>

            </div>
        </form>
    </div>

    <!-- Popup Nama -->
    <div id="popupNama">
        <ul id="daftarNama"></ul>
        <button onclick="tutupPopup()">Batal</button>
    </div>

    <script>
        // Font Definitions
        const style = document.createElement('style');
        style.innerHTML = `
            @font-face {
                font-family: 'BookmanOldStyle';
                src: url("fonts/BOOKOS.TTF") format('truetype');
            }
            @font-face {
                font-family: 'bookmanoldstyle_bold';
                src: url("fonts/BOOKOSB.TTF") format('truetype');
            }
        `;
        document.head.appendChild(style);

        // Auto-resize Textarea
        function autoResizeTextarea() {
            const textareas = document.querySelectorAll('textarea');
            textareas.forEach(textarea => {
                textarea.style.height = 'auto';
                textarea.style.height = `${textarea.scrollHeight}px`;
                textarea.addEventListener('input', () => {
                    textarea.style.height = 'auto';
                    textarea.style.height = `${textarea.scrollHeight}px`;
                });
            });
        }

        // Hide Table
        function hideTable() {
            document.getElementById('tabelPenduduk').style.display = 'none';
        }
		
	
//-------------------POPUP NAMA ALMARHUM//

	
		
//-------------------calon pengantin//
// Cache untuk data calon pengantin
        let calonPengantinCache = JSON.parse(localStorage.getItem('calonPengantinCache')) || null;

        // Buka popup dan isi data jika ada
        function bukaPopupCalonPengantin() {
            const popup = document.getElementById('popupInputCalonPengantin');
            popup.style.display = 'block';
            if (calonPengantinCache) {
                document.getElementById('inputCalonNama').value = calonPengantinCache.nama || '';
                document.getElementById('inputCalonBin').value = calonPengantinCache.bin || '';
                document.getElementById('inputCalonNIK').value = calonPengantinCache.nik || '';
                document.getElementById('inputCalonTempatLahir').value = calonPengantinCache.tempatlahir || '';
                document.getElementById('inputCalonTanggalLahir').value = calonPengantinCache.tgllahir || '';
                document.getElementById('inputCalonJenisKelamin').value = calonPengantinCache.jeniskelamin || '';
                document.getElementById('inputCalonPekerjaan').value = calonPengantinCache.pekerjaan || '';
                document.getElementById('inputCalonAlamatDusun').value = calonPengantinCache.alamatdusun || '';
                document.getElementById('inputCalonDesa').value = calonPengantinCache.desa || '';
            }
        }

        // Tutup popup dan NAMA_WALIkan form
        function tutupPopupCalonPengantin() {
            document.getElementById('popupInputCalonPengantin').style.display = 'none';
            document.getElementById('formInputCalonPengantin').reset();
        }

        // Simpan data calon pengantin
function simpanDataCalonPengantin() {
            const data = {
                nama: document.getElementById('inputCalonNama').value.trim(),
                bin: document.getElementById('inputCalonBin').value.trim(),
                nik: document.getElementById('inputCalonNIK').value.trim(),
                tempatlahir: document.getElementById('inputCalonTempatLahir').value.trim(),
                tgllahir: document.getElementById('inputCalonTanggalLahir').value.trim(),
                jeniskelamin: document.getElementById('inputCalonJenisKelamin').value.trim().toUpperCase(),
                pekerjaan: document.getElementById('inputCalonPekerjaan').value.trim(),
                alamatdusun: document.getElementById('inputCalonAlamatDusun').value.trim(),
                desa: document.getElementById('inputCalonDesa').value.trim(),
                status: 'B' // Belum Kawin
            };

            if (!data.nama || !data.bin || !data.nik || !data.tempatlahir || !data.tgllahir || !data.jeniskelamin || !data.pekerjaan || !data.alamatdusun || !data.desa) {
                alert('Semua kolom harus diisi.');
                return;
            }

            // Validasi jenis kelamin
            if (!['L', 'LAKI-LAKI', 'P', 'PEREMPUAN'].includes(data.jeniskelamin)) {
                alert('Jenis kelamin harus L, LAKI-LAKI, P, atau PEREMPUAN.');
                return;
            }

            // Simpan ke localStorage
            calonPengantinCache = data;
            localStorage.setItem('calonPengantinCache', JSON.stringify(data));

            // Perbarui kolom H2_5 (selalu baris kedua, tanpa mempertimbangkan jenis kelamin)
            let currentH25 = document.getElementById('H2_5').innerHTML.split('<br>');
            let teksH25 = ':  <strong style="font-family: bookmanoldstyle_bold, serif;">' + data.nama + '</strong>';
            currentH25[1] = teksH25; // Ganti baris kedua tanpa kondisi
            document.getElementById('H2_5').innerHTML = currentH25.join('<br>');
            document.getElementById('H2_5').contentEditable = "true";

            // Perbarui kolom H3_6 atau H3_8 berdasarkan jenis kelamin (hanya sentuh salah satu)
            let teksCandidate = ': <strong style="font-family: bookmanoldstyle_bold, serif;">' + data.nama + '</strong><br>' +			
                               ': ' + data.bin + '<br>' +
                               ': ' + data.nik + '<br>' +
                               ': ' + data.tempatlahir + ', ' + data.tgllahir + '<br>' +
                               ': Indonesia<br>' +
                               ': Islam<br>' +
                               ': ' + data.pekerjaan + '<br>' +
                               '<span class="hanging-indent"; text-align: justify;>:&nbsp' + data.alamatdusun + ' Gampong ' + data.desa + ' Kecamatan Jangka Kabupaten Bireuen</span>';

            if (data.jeniskelamin === 'L' || data.jeniskelamin === 'LAKI-LAKI') {
                document.getElementById('H3_8').innerHTML = teksCandidate;
                document.getElementById('H3_8').contentEditable = "true";
                // Update H3_7 untuk "Bin"
                let currentH37 = document.getElementById('H3_7').value.split('\n');
                currentH37[1] = '2. Bin'; // Ubah baris kedua menjadi "Bin"
                document.getElementById('H3_7').value = currentH37.join('\n');
                // Update H4_11 untuk "Bin"
                let currentH411 = document.getElementById('H4_11').value.split('\n');
                currentH411[1] = '2. Bin'; // Ubah baris kedua menjadi "Bin"
                document.getElementById('H4_11').value = currentH411.join('\n');
            } else if (data.jeniskelamin === 'P' || data.jeniskelamin === 'PEREMPUAN') {
                document.getElementById('H3_8').innerHTML = teksCandidate;
                document.getElementById('H3_8').contentEditable = "true";
                // Update H3_7 untuk "Binti"
                let currentH37 = document.getElementById('H3_7').value.split('\n');
                currentH37[1] = '2. Binti'; // Ubah baris kedua menjadi "Binti"
                document.getElementById('H3_7').value = currentH37.join('\n');
                // Update H4_11 untuk "Binti"
                let currentH411 = document.getElementById('H4_11').value.split('\n');
                currentH411[1] = '2. Binti'; // Ubah baris kedua menjadi "Binti"
                document.getElementById('H4_11').value = currentH411.join('\n');
            }

            // Perbarui kolom H3_9 (format khusus dengan CALON SUAMI atau CALON ISTERI berdasarkan jenis kelamin)
            let teks13 = ' <br>' +
                        (data.jeniskelamin === 'L' || data.jeniskelamin === 'LAKI-LAKI' ? 'CALON SUAMI <br>' : 'CALON ISTERI <br>') +
                        ' <br>' +
                        ' <br>' +
                        ' <br>' +
                        ' <strong style="font-family: bookmanoldstyle_bold, serif;">' + data.nama + '</strong><br>';
            document.getElementById('H3_9').innerHTML = teks13;
            document.getElementById('H3_9').contentEditable = "true";

            // Perbarui kolom H4_6 dan H4_12 (tanpa Nama Bin, format lama dengan NAMA-AYAH)
            let teksCandidateLama = ': <strong style="font-family: bookmanoldstyle_bold, serif;">' + data.nama + '</strong><br>' +
                                  ': ' + data.bin + '<br>' +
                                  ': ' + data.nik + '<br>' +
                                  ': ' + data.tempatlahir + ', ' + data.tgllahir + '<br>' +
                                  ': Indonesia<br>' +
                                  ': Islam<br>' +
                                  ': ' + data.pekerjaan + '<br>' +
                                  '<span class="hanging-indent"; text-align: justify;>:&nbsp' + data.alamatdusun + ' Gampong ' + data.desa + ' Kecamatan Jangka Kabupaten Bireuen</span>';

            document.getElementById('H4_12').innerHTML = teksCandidateLama;
            document.getElementById('H4_12').contentEditable = "true";

            // Tutup popup
            tutupPopupCalonPengantin();

            // Ubah warna tombol menjadi hijau
            document.getElementById('btnInputCalonPengantin').style.backgroundColor = '#28a745';
        }


//---------------------//




        // Fetch Cell Data
        function ambilCell() {
            const tabel = document.getElementById("tabelPenduduk");
            if (tabel && tabel.rows.length > 1) {
                const kode = tabel.rows[1].cells[0]?.innerText || "Data tidak ada";
                const nama = tabel.rows[1].cells[3]?.innerText || "Data tidak ada";
                const nik = tabel.rows[1].cells[2]?.innerText || "Data tidak ada";
                const tempatlahir = tabel.rows[1].cells[4]?.innerText || "Data tidak ada";
                const tgllahir = tabel.rows[1].cells[5]?.innerText || "Data tidak ada";
                const job = tabel.rows[1].cells[8]?.innerText || "Data tidak ada";
                const dusun = tabel.rows[1].cells[9]?.innerText || "Data tidak ada";
                const desa = tabel.rows[1].cells[10]?.innerText || "Data tidak ada";
                let jeniskelamin = tabel.rows[1].cells[7]?.innerText.trim() || "Data tidak ada";
					if (jeniskelamin === "L") {
						jeniskelamin = "Laki-Laki";
					} else if (jeniskelamin === "P") {
						jeniskelamin = "Perempuan";
					}
				let status = tabel.rows[1].cells[6]?.innerText.trim() || "Data tidak ada";
					if (status === "B") {
						status = "Belum Kawin";
					} else if (status === "S") {
						status = "Sudah Kawin";
					} else if (status === "P") {
						status = "Pernah Kawin";
					}
				let statusPerkawinanLaki = jeniskelamin === "Laki-Laki" ? getStatusPerkawinanLaki(status) : "-";
				let statusPerkawinanPerempuan = jeniskelamin === "Perempuan" ? getStatusPerkawinanPerempuan(status) : "-";

				
				
				document.getElementById('H1_1').value = `LAMPIRAN  IV\nKEPUTUSAN DIREKTUR JENDERAL BIMBINGAN MASYARAKAT ISLAM\nNOMOR 473 TAHUN 2020\nTENTANG\nPETUNJUK TEKNIS PELAKSANAAN PENCATATAN PERNIKAHAN`;
				document.getElementById('H2_1').value = `LAMPIRAN  VI\nKEPUTUSAN DIREKTUR JENDERAL BIMBINGAN MASYARAKAT ISLAM\nNOMOR 473 TAHUN 2020\nTENTANG\nPETUNJUK TEKNIS PELAKSANAAN PENCATATAN PERNIKAHAN`;
				document.getElementById('H3_1').value = `LAMPIRAN  VIII\nKEPUTUSAN DIREKTUR JENDERAL BIMBINGAN MASYARAKAT ISLAM\nNOMOR 473 TAHUN 2020\nTENTANG\nPETUNJUK TEKNIS PELAKSANAAN PENCATATAN PERNIKAHAN`;
				document.getElementById('H4_1').value = `LAMPIRAN  IX\nKEPUTUSAN DIREKTUR JENDERAL BIMBINGAN MASYARAKAT ISLAM\nNOMOR 473 TAHUN 2020\nTENTANG\nPETUNJUK TEKNIS PELAKSANAAN PENCATATAN PERNIKAHAN`;

				document.getElementById('H1_2').value = `KANTOR DESA/ KELURAHAN\nKECAMATAN\nKABUPATEN/KOTA`;
				document.getElementById('H1_3').value = `: ${desa}\n: JANGKA\n: BIREUEN`.toUpperCase();
				document.getElementById('H1_4').value = `NOMOR :        /       / ${kode} /${getDate()}`;
				document.getElementById('H1_5').value = `1. Nama\n2. Nomor Induk  Kependudukan (NIK)\n3. Jenis Kelamin\n4. Tempat/Tgl.Lahir\n5. Warga Negara\n6. Agama\n7. Pekerjaan\n8. Alamat\n\n9. Status Perkawinan\n      a.   Laki-laki: Jejaka, Duda\n            Atau Beristri ke...\n      b.   Perempuan: Perawan, Janda`;

				let teks = ': <strong style="font-family: bookmanoldstyle_bold, serif;">' + nama + '</strong><br>' +
           ': ' + nik + '<br>' +
           ': ' + jeniskelamin + '<br>' +
           ': ' + tempatlahir + ', ' + tgllahir + '<br>' +
           ': Indonesia<br>' +
           ': Islam<br>' +
           ': ' + job + '<br>' +
           '<span class="hanging-indent"; text-align: justify;>:&nbsp' + dusun + ' Gampong ' + desa + ' Kecamatan Jangka Kabupaten Bireuen</span>' +
		   ': ' + status + '<br>' +
		   ': ' + statusPerkawinanLaki + '<br>' +
		   ': -<br>' +
		   ': ' + statusPerkawinanPerempuan
		   ;
				document.getElementById('H1_6').innerHTML = teks;
				document.getElementById('H1_6').contentEditable = "true"; 
//-----------------------------------------------------------------------------------//
				document.getElementById('H1_7').value = `1. Nama lengkap dan alias \n2. Tempat dan tanggal lahir\n3. Nomor Induk  Kependudukan (NIK)\n4. Warganegaraan\n5. Agama\n6. Pekerjaan\n7. Alamat`;
let teks2 = ':  <br>' +
           ':  <br>' +
           ':  &nbsp; * Pilih Nama <strong style="font-family: bookmanoldstyle_bold, serif;">AYAH </strong> di Tombol kiri atas (NO.1)<br>' +
           ':  &nbsp; * Lalu pilih Nama orang Tua yang benar <br>' +
           ':  &nbsp;    Atau bisa juga Input Menual<br>' +		   
           '<span class="hanging-indent">:&nbsp&nbsp</span>' +
		   ':  <br>' 
		   ;
				document.getElementById('H1_8').innerHTML = teks2;
				document.getElementById('H1_8').contentEditable = "true"; 
//-----------------------------------------------------------------------------------//
				document.getElementById('H1_9').value = `1. Nama lengkap dan alias \n2. Tempat dan tanggal lahir\n3. Nomor Induk  Kependudukan (NIK)\n4. Warganegaraan\n5. Agama\n6. Pekerjaan\n7. Alamat`;
let teks3 = ':  <br>' +
           ':  <br>' +
           ':  &nbsp; * Pilih Nama <strong style="font-family: bookmanoldstyle_bold, serif;">IBU </strong> di Tombol kiri atas (NO.2)<br>' +
           ':  &nbsp; * Lalu pilih Nama orang Tua yang benar <br>' +
           ':  &nbsp;    Atau bisa juga Input Menual<br>' +		   
           '<span class="hanging-indent">:&nbsp&nbsp</span>' +
		   ':  <br>' 
		   ;
				document.getElementById('H1_10').innerHTML = teks3;
				document.getElementById('H1_10').contentEditable = "true"; 
//-----------------------------------------------------------------------------------//










fetchKepalaDesa(desa).then(kepalaDesa => {
    let teks4 = desa + ', ' + getFormattedDate() + ' <br>' +
                'KEUCHIK GAMPONG' + '<br>' +
                '<br>' +
                '<br>' +
                '<br>' +
				'<br>' +
                '<strong style="text-decoration: underline; text-underline-offset: 4px;font-family: bookmanoldstyle_bold, serif;">' + kepalaDesa + '</strong>';
    document.getElementById('H1_11').innerHTML = teks4;
    document.getElementById('H1_11').contentEditable = "true"; 
});

//-----------------------------------------------------------------------------------//
let teks5 = desa + ', ' + getFormattedDate() + ' <br>' +
            'Kepada yth,<br>' +
            'Kepala KUA Kecamatan /PPN LN<br>' +
            '<span style="margin-left: 20px;">di Jangka</span><br>';
document.getElementById('H2_3').innerHTML = teks5;
document.getElementById('H2_3').contentEditable = "true";
//-----------------------------------------------------------------------------------//
// Normalisasi jeniskelamin
            jeniskelamin = jeniskelamin.toUpperCase().replace(/\s+/g, ''); // Ubah ke huruf besar dan hapus spasi
            console.log("Jenis kelamin dari tabel:", jeniskelamin); // Debugging

            // Tentukan baris untuk H2_4 berdasarkan jenis kelamin
            let h24Lines = [
                'Hari/Tanggal/Jam',
                'Tempat Akad Nikah',
                'Maskawin Berupa'
            ];
            if (jeniskelamin === 'L' || jeniskelamin === 'LAKI-LAKI') {
                h24Lines.unshift('Calon Suami', 'Calon Istri'); // Baris 1: Calon Suami, Baris 2: Calon Istri
            } else if (jeniskelamin === 'P' || jeniskelamin === 'PEREMPUAN') {
                h24Lines.unshift('Calon Isteri', 'Calon Suami'); // Baris 1: Calon Isteri, Baris 2: Calon Suami
            } else {
                h24Lines.unshift('Calon Suami', 'Calon Istri'); // Default jika jenis kelamin tidak valid
                console.warn("Jenis kelamin tidak valid:", jeniskelamin, ". Menggunakan default.");
            }
            document.getElementById('H2_4').value = h24Lines.join('\n');

            // Atur H2_5
            let teks6 = ':  <strong style="font-family: bookmanoldstyle_bold, serif;">' + nama + '</strong><br>' +
                        ':  <strong style="font-family: bookmanoldstyle_bold, serif;">Nama Calon belum ada</strong><br>' +
                        ':  ....... <br>' +
                        ':  Di Kantor KUA Kecamatan Jangka <br>' +
                        ':  ..... Manyam';
            document.getElementById('H2_5').innerHTML = teks6;
            document.getElementById('H2_5').contentEditable = "true";
//-----------------------------------------------------------------------------------//
		document.getElementById('H2_6').value = `1. \n2. \n3. \n4. \n5. \n6. \n7. \n8. \n9. \n10. \n11. \n12. `;
const teks7 = 'Surat pengantar nikah dari Desa/Kelurahan ( N1,N2,N4) <br>' +
			'Surat Izin Orang Tua jika Catin berumur dibawah 21 tahun ( N5) <br>' +
			'Surat Keterangan Kematian bagi yang duda/janda Meninggal ( N6) <br>' +
			'Surat Akta Cerai /Talak Bagi Duda/Janda dari Mahkamah Syariyah <br>' +
			'Dispendasikawin dari Mahkamah Syariyah apabila catin belum mencapai umur 19 Tahun <br>' +
			'Fotocopi KTP (Catin, Orang Tua, Wali, dan Saksi) <br>' +
			'Fotocopi akte Kelahiran/ surat Keterangan Kelahiran dari Desa  <br>' +
			'Fotocopi  Kartu  Keluarga <br>' +
			'Fotocopy Ijazah Terakhir, Jika ada <br>' +
			'Paspoto 2x3 = 4 lembar, 4x6 = 1 Lembar dan 3x4= 3 Lembar berlatar Belakang Biru <br>' +
			'Surat Pernyataan Jejaka bagi Catin Laki-Laki diatas Materai 10.000 <br>' +
			'Surat Kesehatan/Plano Test  dari Puskesmas  bagi catin Perempuan. <br>'

document.getElementById('H2_7').innerHTML = teks7;
document.getElementById('H2_7').contentEditable = "true";
//-----------------------------------------------------------------------------------//

let teks8 = 'Wassalam, <br>' +
            'Pemohon <br>' +
            ' <br>' +
            ' <br>' +
			' <br>' +
			' <br>' +
			'<strong style="font-family: bookmanoldstyle_bold, serif;">' + nama + '</strong><br>';
document.getElementById('H2_8').innerHTML = teks8;
document.getElementById('H2_8').contentEditable = "true";

//-----------------------------------------------------------------------------------//

let teks9 = 'Diterima Tanggal : ............... <br>' +
            'Yang menerima, <br>' +
            'Kepala KUA <br>' +
            ' <br>' +
			' <br>' +
			' <br>' +
			' ( ........................ )';
document.getElementById('H2_9').innerHTML = teks9;
document.getElementById('H2_9').contentEditable = "true";

//-----------------------------------------------------------------------------------//

// Perbarui p3_1 dan p3_2 (Halaman 3)
                if (jeniskelamin === 'L' || jeniskelamin === 'LAKI-LAKI') {
                    document.getElementById('p3_1').innerHTML = 'Yang bertanda tangan dibawah ini :<br>A.     Calon Suami';
                    document.getElementById('p3_2').innerHTML = 'B.     Calon Isteri';
                } else if (jeniskelamin === 'P' || jeniskelamin === 'PEREMPUAN') {
                    document.getElementById('p3_1').innerHTML = 'Yang bertanda tangan dibawah ini :<br>A.     Calon Isteri';
                    document.getElementById('p3_2').innerHTML = 'B.     Calon Suami';
                } else {
                    document.getElementById('p3_1').innerHTML = 'Yang bertanda tangan dibawah ini :<br>A.     Calon Suami';
                    document.getElementById('p3_2').innerHTML = 'B.     Calon Isteri';
                    console.warn("Jenis kelamin tidak valid untuk p3_1 dan p3_2:", jeniskelamin, ". Menggunakan default.");
                }



document.getElementById('H3_5').value = `1. Nama lengkap alias\n2. Bin\n3. Nomor Induk  Kependudukan (NIK)\n4. Tempat/Tgl.Lahir\n5. Warga Negara\n6. Agama\n7. Pekerjaan\n8. Alamat\n`;

				let teks10 = ': <strong style="font-family: bookmanoldstyle_bold, serif;">' + nama + '</strong><br>' +
				': NAMA-AYAH<br>' +
				': ' + nik + '<br>' +
				': ' + tempatlahir + ', ' + tgllahir + '<br>' +
				': Indonesia<br>' +
				': Islam<br>' +
				': ' + job + '<br>' +
				'<span class="hanging-indent"; text-align: justify;>:&nbsp' + dusun + ' Gampong ' + desa + ' Kecamatan Jangka Kabupaten Bireuen</span>'
				;
				document.getElementById('H3_6').innerHTML = teks10;
				document.getElementById('H3_6').contentEditable = "true"; 
				
				
	// Perbarui H3_5 (baris ke-2 menjadi Bin atau Binti)
                let h35Lines = document.getElementById('H3_5').value.split('\n');
                if (jeniskelamin === 'L' || jeniskelamin === 'LAKI-LAKI') {
                    h35Lines[1] = '2. Bin';
                } else if (jeniskelamin === 'P' || jeniskelamin === 'PEREMPUAN') {
                    h35Lines[1] = '2. Binti';
                } else {
                    h35Lines[1] = '2. Bin';
                    console.warn("Jenis kelamin tidak valid untuk H3_5:", jeniskelamin, ". Menggunakan default Bin.");
                }
                document.getElementById('H3_5').value = h35Lines.join('\n');			
				
				
				
				
				
				
				
				
				
				
//-----------------------------------------------------------------------------------//
document.getElementById('H3_7').value = `1. Nama lengkap alias\n2. Bin\n3. Nomor Induk  Kependudukan (NIK)\n4. Tempat/Tgl.Lahir\n5. Warga Negara\n6. Agama\n7. Pekerjaan\n8. Tempat Tinggal\n`;

				let teks11 = ':  <br>' +
           ':  <br>' +
           ':  &nbsp; * Pilih Nama <strong style="font-family: bookmanoldstyle_bold, serif;">CALON </strong> di Tombol kiri atas (NO.3)<br>' +
           ':  &nbsp;  dan masukkan Data dengan benar<br>' +		   
           '<span class="hanging-indent">:&nbsp&nbsp</span>'+
		   ':  <br>' 
		   ;
				document.getElementById('H3_8').innerHTML = teks11;
				document.getElementById('H3_8').contentEditable = "true"; 		
				
//-----------------------------------------------------------------------------------//

// Perbarui H3_9
                let teks17 = '<br>' +
                             'CALON .... <br>'+
                             ' <br>' +
                             ' <br>' +
                             ' <br>' +
                             '<strong style="font-family: bookmanoldstyle_bold, serif;">Nama Calon belum ada</strong><br>';
                document.getElementById('H3_9').innerHTML = teks17;
                document.getElementById('H3_9').contentEditable = "true";






//-----------------------------------------------------------------------------------//

// Perbarui H3_10
                let teks12 = desa + ', ' + getFormattedDate() + ' <br>' +
                             (jeniskelamin === 'L' || jeniskelamin === 'LAKI-LAKI' ? 'CALON SUAMI <br>' : 'CALON ISTERI <br>') +
                             ' <br>' +
                             ' <br>' +
                             ' <br>' +
                             '<strong style="font-family: bookmanoldstyle_bold, serif;">' + nama + '</strong><br>';
                document.getElementById('H3_10').innerHTML = teks12;
                document.getElementById('H3_10').contentEditable = "true";

//-----------------------------------------------------------------------------------//
// Inisialisasi halaman 4
document.getElementById('H4_1').value = `LAMPIRAN IX\nKEPUTUSAN DIREKTUR JENDERAL BIMBINGAN MASYARAKAT ISLAM\nNOMOR 473 TAHUN 2020\nTENTANG\nPETUNJUK TEKNIS PELAKSANAAN PENCATATAN PERNIKAHAN`;
fetchKepalaDesa(desa).then(kepalaDesa => {
    let teks14 = desa + ', ' + getFormattedDate() + '<br>' +
                'KEUCHIK GAMPONG' + '<br>' +
                '<br><br><br><br>' +
                '<strong style="text-decoration: underline; text-underline-offset: 4px;font-family: bookmanoldstyle_bold, serif;">' + kepalaDesa + '</strong>';
    document.getElementById('H4_11').innerHTML = teks14; // Asumsi ada elemen #H4_11 untuk tanda tangan
    document.getElementById('H4_11').contentEditable = "true";
});
document.getElementById('H4_7').value = `1. Nama lengkap dan alias \n2. Bin\n3. Tempat dan tanggal lahir\n4. Nomor Induk  Kependudukan (NIK)\n5. Warganegaraan\n6. Agama\n7. Pekerjaan\n8. Tempat Tinggal`;
document.getElementById('H4_9').value = `1. Nama lengkap dan alias \n2. Binti\n3. Tempat dan tanggal lahir\n4. Nomor Induk  Kependudukan (NIK)\n5. Warganegaraan\n6. Agama\n7. Pekerjaan\n8. Tempat Tinggal`;
document.getElementById('H4_8').innerHTML = document.getElementById('H1_8').innerHTML;
document.getElementById('H4_10').innerHTML = document.getElementById('H1_10').innerHTML;
//-----------------------------------------------------------------------------------//
document.getElementById('H4_5').value = `1. Nama lengkap alias\n2. Bin\n3. Nomor Induk  Kependudukan (NIK)\n4. Tempat/Tgl.Lahir\n5. Warga Negara\n6. Agama\n7. Pekerjaan\n8. Tempat Tinggal\n`;
				let teks14 = ': <strong style="font-family: bookmanoldstyle_bold, serif;">' + nama + '</strong><br>' +
				': NAMA-AYAH<br>' +
				': ' + nik + '<br>' +
				': ' + tempatlahir + ', ' + tgllahir + '<br>' +
				': Indonesia<br>' +
				': Islam<br>' +
				': ' + job + '<br>' +
				'<span class="hanging-indent"; text-align: justify;>:&nbsp' + dusun + ' Gampong ' + desa + ' Kecamatan Jangka Kabupaten Bireuen</span>'
				;
				document.getElementById('H4_6').innerHTML = teks14;
				document.getElementById('H4_6').contentEditable = "true"; 
					
//-----------------------------------------------------------------------------------//
document.getElementById('H4_11').value = `1. Nama lengkap alias\n2. Bin\n3. Nomor Induk  Kependudukan (NIK)\n4. Tempat/Tgl.Lahir\n5. Warga Negara\n6. Agama\n7. Pekerjaan\n8. Alamat\n`;



        // Update H4_5 baris ke-2 (Bin atau Binti)
        const h45 = document.getElementById('H4_5');
        if (h45) {
            let h45Lines = h45.value.split('\n');
            if (jeniskelamin === 'L' || jeniskelamin === 'LAKI-LAKI') {
                h45Lines[1] = '2. Bin';
            } else if (jeniskelamin === 'P' || jeniskelamin === 'PEREMPUAN') {
                h45Lines[1] = '2. Binti';
            } else {
                h45Lines[1] = '2. Bin';
                console.warn("Jenis kelamin tidak valid untuk H4_5:", jeniskelamin, ". Menggunakan default Bin.");
            }
            h45.value = h45Lines.join('\n');
        } else {
            console.warn("Elemen H4_5 tidak ditemukan.");
        }
   

//-----------------------------------------------------------------------------------//
 let teks24 = desa + ', ' + getFormattedDate() + ' <br>' +
                'IBU' + '<br>' +
                '<br>' +
				'<br>' +
                '<strong style="font-family: bookmanoldstyle_bold, serif;">' + nama + '</strong>';
    document.getElementById('H4_13').innerHTML = teks24;
    document.getElementById('H4_13').contentEditable = "true"; 

//-----------------------------------------------------------------------------------//

 let teks25 = desa + ', ' + getFormattedDate() + ' <br>' +
                'AYAH' + '<br>' +
                '<br>' +
				'<br>' +
                '<strong style="font-family: bookmanoldstyle_bold, serif;">Menunggu...</strong>';
    document.getElementById('H4_14').innerHTML = teks25;
    document.getElementById('H4_14').contentEditable = "true"; 

//-----------------------------------------------------------------------------------//





			
            }
			
			let teks33 = ':  <br>' +
           ':  <br>' +
           ':  &nbsp; * Pilih Nama <strong style="font-family: bookmanoldstyle_bold, serif;">IBU</strong> di Tombol kiri atas (NO.2)<br>' +
           ':  &nbsp; * atau centang  sebelah kanan Tombol <br>' +
           ':  &nbsp;  kalau memang sudah MENINGGAL<br>' +		   
           '<span class="hanging-indent">:&nbsp&nbsp</span>' +
		   ':  <br>' 
		   ;
				document.getElementById('H1_12').innerHTML = teks33;
				document.getElementById('H1_12').contentEditable = "true";  

        }


// === Popup Loader untuk Mengisi H1_8 Secara Manual dari Data Tabel ===

// === Popup AYAh page1===
function bukaPopupH18() {
    const btn = document.getElementById('btnH18Popup');
    const popup = document.getElementById('popupNama');
    const rect = btn.getBoundingClientRect();

    popup.style.top = `${rect.top + window.scrollY}px`;
    popup.style.left = `${rect.right + 10}px`; // Geser sedikit ke kanan
    popup.style.display = 'block';
		document.body.classList.add('popup-active'); // Nonaktifkan scroll
    isiPopupH18('H1_8');
}

// === Popup Ibu ===
function bukaPopupH110() {
    const btn = document.getElementById('btnH110Popup');
    const popup = document.getElementById('popupNama');
    const rect = btn.getBoundingClientRect();

    popup.style.top = `${rect.top + window.scrollY}px`;
    popup.style.left = `${rect.right + 10}px`;
    popup.style.display = 'block';

    isiPopupH18('H1_10');
}

function isiPopupH18(targetId) {
            const daftarNama = document.getElementById('daftarNama');
            daftarNama.innerHTML = '';

            combinedData.checked.forEach((item) => {
                const listItem = document.createElement('li');
                listItem.textContent = item.nama;
                listItem.style.cursor = 'pointer';
                listItem.onclick = () => pilihNamaH18(item.nama, targetId);
                daftarNama.appendChild(listItem);
            });

            // Add manual input button
            const manualButton = document.createElement('button');
            manualButton.textContent = 'Tambah Data Manual';
            manualButton.style.marginTop = '15px';
            manualButton.onclick = () => bukaPopupManualInput(targetId);
            daftarNama.appendChild(manualButton);
        }

function pilihNamaH18(namaTerpilih, targetId) {
            const popup = document.getElementById('popupNama');
            const daftarNama = document.getElementById('daftarNama');

            daftarNama.innerHTML = '';

            const label = document.createElement('label');
            label.className = 'input-kakek-label';
            label.innerHTML = '<span style="margin-bottom: 12px; display: inline-block;">Masukkan Nama Kakek, jika sudah menjadi   maka gunakan (Alm). </span><br>';

            const inputKakek = document.createElement('input');
            inputKakek.type = 'text';
            inputKakek.className = 'input-kakek';
            inputKakek.placeholder = 'ex. NAMA KAKEK (Alm)';
            inputKakek.id = 'inputNamaKakek';

            const submitButton = document.createElement('button');
            submitButton.textContent = 'Kirim';
            submitButton.className = 'submit-kakek';
            submitButton.onclick = () => submitNamaKakek(namaTerpilih, targetId);

            daftarNama.appendChild(label);
            daftarNama.appendChild(inputKakek);
            daftarNama.appendChild(submitButton);
            popup.style.display = 'block';
        }


function submitNamaKakek(namaTerpilih, targetId) {
    const popup = document.getElementById('popupNama');
    const daftarNama = document.getElementById('daftarNama');
    const inputKakek = document.getElementById('inputNamaKakek');
    const namaKakek = inputKakek ? inputKakek.value.trim() || '................... (Alm)' : '................... (Alm)';

    popup.style.display = 'none';
    daftarNama.innerHTML = '';

    const penduduk = combinedData.checked.find(item => item.nama === namaTerpilih) || {
        nama: namaTerpilih,
        tempatlahir: '-',
        tgllahir: '-',
        nik: '-',
        pekerjaan: '-',
        alamatdusun: '-',
        desa: '-',
        jeniskelamin: 'L'
    };

    const isDeceased = namaTerpilih.includes('(Alm)');
    let isiH1, isiH4;

    if (isDeceased) {
        isiH1 = `: <strong style="font-family: bookmanoldstyle_bold, serif;text-align: justify;">${penduduk.nama}</strong><br>` +
                ': -<br>' +
                ': -<br>' +
                ': -<br>' +
                ': -<br>' +
                ': -<br>' +
                '<span class="hanging-indent">: -</span><br>';
        isiH4 = `: <strong style="font-family: bookmanoldstyle_bold, serif;text-align: justify;">${penduduk.nama}</strong><br>` +
                `: ${namaKakek}<br>` +
                ': -<br>' +
                ': -<br>' +
                ': -<br>' +
                ': -<br>' +
                '<span class="hanging-indent">: -</span><br>';
    } else {
        const jk = penduduk.jeniskelamin === 'L' ? 'Laki-Laki' : (penduduk.jeniskelamin === 'P' ? 'Perempuan' : penduduk.jeniskelamin);
        isiH1 = `: <strong style="font-family: bookmanoldstyle_bold, serif;text-align: justify;">${penduduk.nama}</strong><br>` +
                `: ${penduduk.tempatlahir}, ${formatDate(penduduk.tgllahir)}<br>` +
                `: ${penduduk.nik}<br>` +
                ': Indonesia<br>' +
                ': Islam<br>' +
                `: ${penduduk.pekerjaan}<br>` +
                `<span class="hanging-indent">: ${penduduk.alamatdusun} Gampong ${penduduk.desa} Kecamatan Jangka Kabupaten Bireuen</span><br>`;
        isiH4 = `: <strong style="font-family: bookmanoldstyle_bold, serif;text-align: justify;">${penduduk.nama}</strong><br>` +
                `: ${namaKakek}<br>` +
                `: ${penduduk.tempatlahir}, ${formatDate(penduduk.tgllahir)}<br>` +
                `: ${penduduk.nik}<br>` +
                ': Indonesia<br>' +
                ': Islam<br>' +
                `: ${penduduk.pekerjaan}<br>` +
                `<span class="hanging-indent">: ${penduduk.alamatdusun} Gampong ${penduduk.desa} Kecamatan Jangka Kabupaten Bireuen</span><br>`;
    }

    const tanggalSekarang = new Date();
    const namaBulan = ['Januari', 'Februari', 'Maret', 'April', 'Mei', 'Juni', 'Juli', 'Agustus', 'September', 'Oktober', 'November', 'Desember'];
    const tanggalFormatted = `${tanggalSekarang.getDate().toString().padStart(2, '0')} ${namaBulan[tanggalSekarang.getMonth()]} ${tanggalSekarang.getFullYear()}`;
    const tabel = document.querySelector('table');
    const desa = tabel.rows[1].cells[10]?.innerText || "Data tidak ada";
    const desaTanggal = `${desa}, ${tanggalFormatted}`;

    const target = document.getElementById(targetId);
    target.innerHTML = isiH1;
    target.setAttribute('data-nama', penduduk.nama);

    // Update fields based on targetId
    if (targetId === 'H1_8') {
        document.getElementById('H4_8').innerHTML = isiH4;
        document.getElementById('H4_8').setAttribute('data-nama', penduduk.nama);

        const namaAyah = `: <strong style="font-family: bookmanoldstyle_bold, serif;text-align: justify;">${penduduk.nama}</strong>`;
        ['H3_6', 'H4_6'].forEach(id => {
            const element = document.getElementById(id);
            let lines = element.innerHTML.split('<br>');
            if (lines.length >= 2) {
                lines[1] = namaAyah;
                element.innerHTML = lines.join('<br>');
            } else {
                element.innerHTML = (lines[0] || '') + '<br>' + namaAyah;
            }
            element.setAttribute('data-nama', penduduk.nama);
        });

        const btnH18Popup = document.getElementById('btnH18Popup');
        if (btnH18Popup) btnH18Popup.style.backgroundColor = '#28a745';
        if (typeof EnableTombol_IBU === 'function') EnableTombol_IBU();
    }

    if (targetId === 'H1_10') {
        document.getElementById('H4_10').innerHTML = isiH4;
        document.getElementById('H4_10').setAttribute('data-nama', penduduk.nama);

        const btnH110Popup = document.getElementById('btnH110Popup');
        if (btnH110Popup) btnH110Popup.style.backgroundColor = '#28a745';
        const btnInputCalonPengantin = document.getElementById('btnInputCalonPengantin');
        if (btnInputCalonPengantin) btnInputCalonPengantin.style.backgroundColor = '#91908d';
        if (typeof EnableTombol_PENGANTIN === 'function') EnableTombol_PENGANTIN();
    }

    // Signature logic
    let fatherData = combinedData.checked.find(item => item.nama === document.getElementById('H1_8')?.getAttribute('data-nama'));
    let motherData = combinedData.checked.find(item => item.nama === document.getElementById('H1_10')?.getAttribute('data-nama'));
    const h4_14Element = document.getElementById('H4_14');
    const h4_13Element = document.getElementById('H4_13');

    // Case 1: Check if H4_14 is "Menunggu..."
    const isH4_14Waiting = h4_14Element && h4_14Element.innerHTML.includes('Menunggu...');
    if (isH4_14Waiting) {
        // Prioritize father if alive
        if (fatherData && !fatherData.nama.includes('(Alm)')) {
            h4_14Element.innerHTML = `${desaTanggal}<br>` +
                                    'AYAH<br>' +
                                    '<br><br><br>' +
                                    `<strong style="font-family: bookmanoldstyle_bold, serif;text-align: justify;">${fatherData.nama}</strong>`;
            h4_14Element.setAttribute('data-nama', fatherData.nama);

            // Set mother in H4_13 if available and alive, else "NAMA_WALI"
            if (motherData && !motherData.nama.includes('(Alm)')) {
                h4_13Element.innerHTML = `${desaTanggal}<br>` +
                                        'IBU-1<br>' +
                                        '<br><br><br>' +
                                        `<strong style="font-family: bookmanoldstyle_bold, serif;text-align: justify;">${motherData.nama}</strong>`;
                h4_13Element.setAttribute('data-nama', motherData.nama);
            } else {
                h4_13Element.innerHTML = '<br>' +
                                        'WALI/PENGAMPUN<br>' +
                                        '<br><br><br>' +
                                        '<strong style="font-family: bookmanoldstyle_bold, serif;text-align: justify;">NAMA_WALI</strong>';
                h4_13Element.setAttribute('data-nama', 'NAMA_WALI');
            }
        } else {
            // If father is deceased or unavailable, set H4_14 to "AYAH_MATI"
            h4_14Element.innerHTML = '<br>' +
                                    'AYAH/WALI/PENGAMPUN<br>' +
                                    '<br><br><br>' +
                                    '<strong style="font-family: bookmanoldstyle_bold, serif;text-align: justify;">AYAH_MATI</strong>';
            h4_14Element.setAttribute('data-nama', 'AYAH_MATI');

            // Set H4_13 to "NAMA_WALI"
            h4_13Element.innerHTML = `${desaTanggal}<br>` +
                                    'IBU/WALI/PENGAMPUN<br>' +
                                    '<br><br><br>' +
                                    '<strong style="font-family: bookmanoldstyle_bold, serif;text-align: justify;">NAMA_WALI</strong>';
            h4_13Element.setAttribute('data-nama', 'NAMA_WALI');
        }
    }
    // Case 2: Check if H4_14 is "AYAH_MATI"
    else if (h4_14Element.getAttribute('data-nama') === 'AYAH_MATI') {
        // Prioritize mother if alive
        if (motherData && !motherData.nama.includes('(Alm)')) {  // -----------------------------------INI UNTUK H4_14
            h4_14Element.innerHTML = `${desaTanggal}<br>` +
                                    'IBU<br>' +
                                    '<br><br><br>' +
                                    `<strong style="font-family: bookmanoldstyle_bold, serif;text-align: justify;">${motherData.nama}</strong>`;
            h4_14Element.setAttribute('data-nama', motherData.nama);

            // Set H4_13 to "NAMA_WALI"
            h4_13Element.innerHTML = '<br>' +
                                    'WALI/PENGAMPUN<br>' +
                                    '<br><br><br>' +
                                    '<strong style="font-family: bookmanoldstyle_bold, serif;text-align: justify;">NAMA_WALI</strong>';
            h4_13Element.setAttribute('data-nama', 'NAMA_WALI');
        } else {
            // If mother is deceased or unavailable, set H4_14 to "IBU_MATI"
            h4_14Element.innerHTML = `${desaTanggal}<br>` + // -----------------------------------INI UNTUK H4_14
                                    'AYAH/WALI/PENGAMPUN<br>' +
                                    '<br><br><br>' +
                                    '<strong style="font-family: bookmanoldstyle_bold, serif;text-align: justify;">NAMA_WALI</strong>';
            h4_14Element.setAttribute('data-nama', 'IBU_MATI');

            // Set H4_13 to "NAMA_WALI"
            h4_13Element.innerHTML = '<br>' +
                                    '<br>' +
                                    '<br><br><br>' +
                                    '<strong style="font-family: bookmanoldstyle_bold, serif;text-align: justify;"></strong>';
            h4_13Element.setAttribute('data-nama', 'NAMA_WALI');
        }
    }
    // Case 3: Check if H4_14 is "IBU_MATI"
    else if (h4_14Element.getAttribute('data-nama') === 'IBU_MATI') {
        // Set H4_14 to "WALI1" and H4_13 to "NAMA_WALI"
        h4_14Element.innerHTML = '<br>' +
                                'AYAH/WALI/PENGAMPUN<br>' +
                                '<br><br><br>' +
                                '<strong style="font-family: bookmanoldstyle_bold, serif;text-align: justify;">WALI1</strong>';
        h4_14Element.setAttribute('data-nama', 'WALI1');

        h4_13Element.innerHTML = `${desaTanggal}<br>` +
                                'WALI/PENGAMPUN<br>' +
                                '<br><br><br>' +
                                '<strong style="font-family: bookmanoldstyle_bold, serif;text-align: justify;">NAMA_WALI</strong>';
        h4_13Element.setAttribute('data-nama', 'NAMA_WALI');
    }
    // Case 4: H4_14 is already assigned, update H4_13 only
    else {
        if (motherData && !motherData.nama.includes('(Alm)')) {
            h4_13Element.innerHTML = '<br>' +
                                    'IBU<br>' +
                                    '<br><br><br>' +
                                    `<strong style="font-family: bookmanoldstyle_bold, serif;text-align: justify;">${motherData.nama}</strong>`;
            h4_13Element.setAttribute('data-nama', motherData.nama);
        } else {
            h4_13Element.innerHTML = '<br>' +
                                    'WALI/PENGAMPUN<br>' +
                                    '<br><br><br>' +
                                    '<strong style="font-family: bookmanoldstyle_bold, serif;text-align: justify;">NAMA_WALI</strong>';
            h4_13Element.setAttribute('data-nama', 'NAMA_WALI');
        }
    }
}






//wwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwwww INPUT MENUAL /////////

function formatDate(dateString) {
            const namaBulan = ['Januari', 'Februari', 'Maret', 'April', 'Mei', 'Juni',
                'Juli', 'Agustus', 'September', 'Oktober', 'November', 'Desember'];
            if (/^(\d{1,2})\/(\d{1,2})\/(\d{4})$/.test(dateString)) {
                const [day, month, year] = dateString.split('/').map(num => parseInt(num, 10));
                return `${day} ${namaBulan[month - 1]} ${year}`;
            }
            const date = new Date(dateString);
            if (isNaN(date.getTime())) return dateString;
            const day = date.getDate().toString().padStart(2, '0');
            const month = namaBulan[date.getMonth()];
            const year = date.getFullYear();
            return `${day} ${month} ${year}`;
        }


function getFormattedDate() {
            const today = new Date();
            const namaBulan = ['Januari', 'Februari', 'Maret', 'April', 'Mei', 'Juni',
                'Juli', 'Agustus', 'September', 'Oktober', 'November', 'Desember'];
            const day = today.getDate().toString().padStart(2, '0');
            const month = namaBulan[today.getMonth()];
            const year = today.getFullYear();
            return `${day} ${month} ${year}`;
        }


function bukaPopupManualInput(targetId) {
            const popup = document.getElementById('popupManualInputOrtu');
            if (!popup) {
                console.error('Popup manual input ortu tidak ditemukan.');
                return;
            }
            document.getElementById('popupNama').style.display = 'none';
            popup.style.display = 'block';
            popup.dataset.targetId = targetId;

            const dusun = combinedData.selected.alamatdusun || '';
            const desa = combinedData.selected.desa || '';
            document.getElementById('manualAlamatDusunOrtu').value = dusun;
            document.getElementById('manualDesaOrtu').value = desa;

            const toggleButton = document.getElementById('toggleDeceasedMode');
            toggleButton.textContent = 'OFF';
            toggleButton.classList.remove('deceased-active');
            showAllInputs();
        }
		
		

        function tutupPopupManualInputOrtu() {
            const popup = document.getElementById('popupManualInputOrtu');
            if (!popup) return;
            popup.style.display = 'none';
            const inputs = [
                'manualNamaOrtu', 'manualNamaKakek', 'manualNIKOrtu',
                'manualTempatLahirOrtu', 'manualTanggalLahirOrtu',
                'manualPekerjaanOrtu', 'manualAlamatDusunOrtu',
                'manualDesaOrtu'
            ];
            inputs.forEach(id => {
                const element = document.getElementById(id);
                if (element) element.value = '';
            });
            const jkSelect = document.getElementById('manualJenisKelaminOrtu');
            if (jkSelect) jkSelect.value = 'L';
            const toggleButton = document.getElementById('toggleDeceasedMode');
            toggleButton.textContent = 'OFF';
            toggleButton.classList.remove('deceased-active');
            showAllInputs();
        }

      function simpanDataManualOrtu() {
            const popup = document.getElementById('popupManualInputOrtu');
            const targetId = popup.dataset.targetId;
            const isDeceasedMode = document.getElementById('toggleDeceasedMode').classList.contains('deceased-active');
            const nama = document.getElementById('manualNamaOrtu').value.trim();
            let namaKakek = document.getElementById('manualNamaKakek').value.trim();
            let nik = document.getElementById('manualNIKOrtu').value.trim();
            let tempatlahir = document.getElementById('manualTempatLahirOrtu').value.trim();
            let tgllahir = document.getElementById('manualTanggalLahirOrtu').value.trim();
            let pekerjaan = document.getElementById('manualPekerjaanOrtu').value.trim();
            let alamatdusun = document.getElementById('manualAlamatDusunOrtu').value.trim();
            let desa = document.getElementById('manualDesaOrtu').value.trim();
            let jeniskelamin = document.getElementById('manualJenisKelaminOrtu').value;

            if (isDeceasedMode) {
                if (!nama) {
                    alert('Nama wajib diisi.');
                    return;
                }
                namaKakek = '-';
                nik = '-';
                tempatlahir = '-';
                tgllahir = '-';
                pekerjaan = '-';
                alamatdusun = '-';
                desa = '-';
                jeniskelamin = 'L';
            } else {
                if (!nama || !nik || !tempatlahir || !tgllahir || !pekerjaan || !alamatdusun || !desa) {
                    alert('Semua kolom wajib diisi, kecuali Nama Kakek.');
                    return;
                }
                const tanggalRegex = /^(\d{1,2})\/(\d{1,2})\/(\d{4})$/;
                if (!tanggalRegex.test(tgllahir)) {
                    alert('Format tanggal harus dd/mm/yyyy (contoh: 06/05/2025 atau 6/5/2025).');
                    return;
                }
                const [day, month, year] = tgllahir.split('/').map(num => num.padStart(2, '0'));
                tgllahir = `${day}/${month}/${year}`;
                const date = new Date(`${year}-${month}-${day}`);
                if (isNaN(date.getTime()) || date.getFullYear() != year || date.getMonth() + 1 != month || date.getDate() != day) {
                    alert('Tanggal tidak valid. Pastikan tanggal, bulan, dan tahun benar.');
                    return;
                }
            }

            const newData = {
                kode: 'MANUAL_ORTU_' + Date.now(),
                kk: 'N/A',
                nik: nik,
                nama: isDeceasedMode ? `${nama} (Alm)` : nama,
                namaKakek: namaKakek,
                tempatlahir: tempatlahir,
                tgllahir: tgllahir,
                status: 'S',
                jeniskelamin: jeniskelamin,
                pekerjaan: pekerjaan,
                alamatdusun: alamatdusun,
                desa: desa
            };

            combinedData.checked.push(newData);
            tutupPopupManualInputOrtu();
            pilihNamaH18(isDeceasedMode ? `${nama} (Alm)` : nama, targetId);
        }

        function toggleDeceasedMode() {
            const toggleButton = document.getElementById('toggleDeceasedMode');
            const inputs = [
                'manualNamaKakek', 'manualNIKOrtu', 'manualTempatLahirOrtu',
                'manualTanggalLahirOrtu', 'manualPekerjaanOrtu',
                'manualAlamatDusunOrtu', 'manualDesaOrtu', 'manualJenisKelaminOrtu'
            ];

            if (toggleButton.classList.contains('deceased-active')) {
                toggleButton.textContent = 'OFF';
                toggleButton.classList.remove('deceased-active');
                showAllInputs();
            } else {
                toggleButton.textContent = 'ON';
                toggleButton.classList.add('deceased-active');
                inputs.forEach(id => {
                    const element = document.getElementById(id);
                    if (element) element.style.display = 'none';
                });
            }
        }

        function showAllInputs() {
            const inputs = [
                'manualNamaKakek', 'manualNIKOrtu', 'manualTempatLahirOrtu',
                'manualTanggalLahirOrtu', 'manualPekerjaanOrtu',
                'manualAlamatDusunOrtu', 'manualDesaOrtu', 'manualJenisKelaminOrtu'
            ];
            inputs.forEach(id => {
                const element = document.getElementById(id);
                if (element) element.style.display = 'block';
            });
        }
		
		
		
		// WWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWW BATAS INPUT MENUAL //







function getStatusPerkawinanLaki(status) {
    if (status === "Belum Kawin") return "Jejaka";
    if (status === "Pernah Kawin") return "Duda";
    return "-";
}

function getStatusPerkawinanPerempuan(status) {
    if (status === "Belum Kawin") return "Perawan";
    if (status === "Pernah Kawin") return "Janda";
    return "-";
}




 

        function getDate() {
            const today = new Date();
            return today.getFullYear();
        }

        // Pindah Data
        function pindahData1() {
            const tabelLama = document.getElementById('tabelPenduduk');
            const tabelBaru = document.getElementById('newTableF4').getElementsByTagName('tbody')[0];

            if (!tabelLama || !tabelBaru) return;

            const rows = tabelLama.querySelectorAll('tbody tr');
            if (rows.length === 0) return;

            const dataPenduduk = [];
            rows.forEach(row => {
                const cells = row.getElementsByTagName('td');
                if (cells.length < 6) return;

                const nama = cells[3].textContent.trim() || '-';
                const nik = cells[2].textContent.trim() || '-';
                const tempatLahir = cells[4].textContent.trim() || '-';
                const tanggalLahir = cells[5].textContent.trim() || '-';

                const formattedTanggalLahir = formatTanggal(tanggalLahir);
                const umur = hitungUmur(formattedTanggalLahir);

                dataPenduduk.push({ nama, nik, tempatLahir, tanggalLahir: formattedTanggalLahir, umur });
            });

            dataPenduduk.sort((a, b) => b.umur - a.umur);
            tabelBaru.innerHTML = '';

            dataPenduduk.forEach((penduduk, index) => {
                const newRow = tabelBaru.insertRow();
                newRow.setAttribute('draggable', true);
                newRow.addEventListener('dragstart', handleDragStart);
                newRow.addEventListener('dragover', handleDragOver);
                newRow.addEventListener('drop', handleDrop);
                newRow.addEventListener('dragleave', handleDragLeave);
                newRow.addEventListener('dragend', handleDragEnd);

                const nomorUrutCell = newRow.insertCell(0);
                nomorUrutCell.textContent = index + 1;
                nomorUrutCell.contentEditable = true;

                const namaCell = newRow.insertCell(1);
                namaCell.textContent = penduduk.nama;

                const nikCell = newRow.insertCell(2);
                nikCell.textContent = penduduk.nik;

                const tempatLahirCell = newRow.insertCell(3);
                tempatLahirCell.textContent = penduduk.tempatLahir;

                const tanggalLahirCell = newRow.insertCell(4);
                tanggalLahirCell.textContent = penduduk.tanggalLahir;

                const statusCell = newRow.insertCell(5);
                statusCell.textContent = index === 0 ? 'Kepala Keluarga' : (index === 1 ? 'Isteri' : `Anak ${index - 1}`);
                statusCell.contentEditable = true;
            });

            document.getElementById('newTableF4').style.display = 'table';
        }

        function formatTanggal(tanggal) {
            const parts = tanggal.split(' ');
            if (parts.length === 3) {
                const hari = parts[0];
                const bulan = getBulanIndex(parts[1]);
                const tahun = parts[2];
                return `${hari}|${bulan}|${tahun}`;
            }
            return tanggal;
        }

        function getBulanIndex(bulanNama) {
            const bulanMap = {
                'Januari': '01', 'Februari': '02', 'Maret': '03', 'April': '04', 'Mei': '05', 'Juni': '06',
                'Juli': '07', 'Agustus': '08', 'September': '09', 'Oktober': '10', 'November': '11', 'Desember': '12'
            };
            return bulanMap[bulanNama] || '00';
        }

        function hitungUmur(tanggalLahir) {
            const today = new Date();
            const [hari, bulan, tahun] = tanggalLahir.split('|').map(Number);
            const birthDate = new Date(tahun, bulan - 1, hari);
            let umur = today.getFullYear() - birthDate.getFullYear();
            const m = today.getMonth() - birthDate.getMonth();
            if (m < 0 || (m === 0 && today.getDate() < birthDate.getDate())) umur--;
            return umur;
        }

        let draggedRow;
        function handleDragStart(event) {
            draggedRow = event.target;
            event.target.classList.add('dragging');
            event.dataTransfer.effectAllowed = 'move';
            document.getElementById('trashBin').style.display = 'block';
        }

        function handleDragOver(event) {
            event.preventDefault();
            event.dataTransfer.dropEffect = 'move';
            const targetRow = event.target.closest('tr');
            if (targetRow && targetRow !== draggedRow) {
                targetRow.classList.add('drop-target');
            }
        }

        function handleDrop(event) {
            event.preventDefault();
            const targetRow = event.target.closest('tr');
            if (targetRow) {
                targetRow.classList.remove('drop-target');
            }
            if (draggedRow !== event.target && targetRow) {
                targetRow.parentNode.insertBefore(draggedRow, targetRow.nextSibling);
            }
            draggedRow.classList.remove('dragging');
            document.getElementById('trashBin').style.display = 'none';
        }

        function handleDragLeave(event) {
            const targetRow = event.target.closest('tr');
            if (targetRow) {
                targetRow.classList.remove('drop-target');
            }
        }

        function handleDragEnd(event) {
            event.target.classList.remove('dragging');
            document.getElementById('trashBin').style.display = 'none';
        }

        function setupTrashBin() {
            const trashBin = document.getElementById('trashBin');
            trashBin.addEventListener('dragover', function(event) {
                event.preventDefault();
                trashBin.classList.add('drag-over');
            });
            trashBin.addEventListener('dragleave', function() {
                trashBin.classList.remove('drag-over');
            });
            trashBin.addEventListener('drop', function(event) {
                event.preventDefault();
                const draggedRow = document.querySelector('.dragging');
                if (draggedRow) {
                    draggedRow.remove();
                    trashBin.classList.remove('drag-over');
                }
                document.getElementById('trashBin').style.display = 'none';
            });
        }

        function tampilkanPopup() {
            document.getElementById('popupForm').style.display = 'block';
        }

        function tutupPopup() {
             document.getElementById('popupNama').style.display = 'none';
        }

        function tambahData() {
            const nama = document.getElementById('nama').value.trim();
            const nik = document.getElementById('nik').value.trim();
            const tempatLahir = document.getElementById('tempatLahir').value.trim();
            const tanggalLahir = document.getElementById('tanggalLahir').value.trim();

            if (!nama || !nik || !tempatLahir || !tanggalLahir) {
                alert('Semua kolom harus diisi.');
                return;
            }

            const formattedTanggalLahir = formatTanggal(tanggalLahir);
            const tabelBaru = document.getElementById('newTableF4').getElementsByTagName('tbody')[0];
            const newRow = tabelBaru.insertRow();

            newRow.setAttribute('draggable', true);
            newRow.addEventListener('dragstart', handleDragStart);
            newRow.addEventListener('dragover', handleDragOver);
            newRow.addEventListener('drop', handleDrop);
            newRow.addEventListener('dragleave', handleDragLeave);
            newRow.addEventListener('dragend', handleDragEnd);

            const nomorUrutCell = newRow.insertCell(0);
            nomorUrutCell.textContent = tabelBaru.rows.length;
            nomorUrutCell.contentEditable = true;

            const namaCell = newRow.insertCell(1);
            namaCell.textContent = nama;

            const nikCell = newRow.insertCell(2);
            nikCell.textContent = nik;

            const tempatLahirCell = newRow.insertCell(3);
            tempatLahirCell.textContent = tempatLahir;

            const tanggalLahirCell = newRow.insertCell(4);
            tanggalLahirCell.textContent = formattedTanggalLahir;

            const statusCell = newRow.insertCell(5);
            statusCell.textContent = 'Anak ' + (tabelBaru.rows.length - 2);
            statusCell.contentEditable = true;

            document.getElementById('newTableF4').style.display = 'table';
            tutupPopup();
        }

        function bukaPopupInput() {
            document.getElementById('popupInputDataBaru').style.display = 'block';
        }

        function tutupPopupInput() {
            document.getElementById('popupInputDataBaru').style.display = 'none';
        }

        function simpanDataBaru() {
            const data = {
                kode: document.getElementById('inputKode').value,
                kk: document.getElementById('inputKK').value,
                nik: document.getElementById('inputNIK').value,
                nama: document.getElementById('inputNama').value,
                tempatlahir: document.getElementById('inputTempatLahir').value,
                tgllahir: document.getElementById('inputTanggalLahir').value,
                status: document.getElementById('inputStatus').value,
                jeniskelamin: document.getElementById('inputJenisKelamin').value,
                pekerjaan: document.getElementById('inputPekerjaan').value,
                alamatdusun: document.getElementById('inputAlamatDusun').value,
                desa: document.getElementById('inputDesa').value
            };

            const tabelBaru = document.getElementById('newTableF4').getElementsByTagName('tbody')[0];
            const newRow = tabelBaru.insertRow();

            newRow.setAttribute('draggable', true);
            newRow.addEventListener('dragstart', handleDragStart);
            newRow.addEventListener('dragover', handleDragOver);
            newRow.addEventListener('drop', handleDrop);
            newRow.addEventListener('dragleave', handleDragLeave);
            newRow.addEventListener('dragend', handleDragEnd);

            newRow.insertCell(0).textContent = tabelBaru.rows.length;
            newRow.insertCell(1).textContent = data.nama;
            newRow.insertCell(2).textContent = data.nik;
            newRow.insertCell(3).textContent = data.tempatlahir;
            newRow.insertCell(4).textContent = data.tgllahir;
            newRow.insertCell(5).textContent = data.status;

            tutupPopupInput();
        }

        const GAS_URL = 'https://script.google.com/macros/s/AKfycbw-vARiPzX3E4qoai7LV4gwhaEqhoC5EvZIpaZHveiy28I10lDQ7-3qSUrM6vSLJ59rgA/exec';

        async function fetchKepalaDesa(desa) {
            try {
                const response = await fetch(`${GAS_URL}?desa=${encodeURIComponent(desa)}`);
                const data = await response.json();
                return data.kepalaDesa;
            } catch (error) {
                console.error('Error saat fetch kepala desa:', error);
                return 'Error mengambil data kepala desa';
            }
        }

        async function tampilkanKepalaDesa() {
            let desa = document.getElementById("t9_2").value.replace('GAMPONG ', '');
            const kepalaDesa = await fetchKepalaDesa(desa);
            document.getElementById('t1k_1').value = kepalaDesa;
        }

        // URL Data Parsing
        const urlParams = new URLSearchParams(window.location.search);
        const data = urlParams.get('data');
        const combinedData = data ? JSON.parse(decodeURIComponent(data)) : { selected: {}, checked: [] };

        function displayData(dataPenduduk) {
            const dataPendudukContainer = document.getElementById('dataPendudukContainer');
            const row = `<tr>
                <td>${dataPenduduk.selected.kode || ''}</td>
                <td>${dataPenduduk.selected.kk || ''}</td>
                <td>${dataPenduduk.selected.nik || ''}</td>
                <td>${dataPenduduk.selected.nama || ''}</td>
                <td>${dataPenduduk.selected.tempatlahir || ''}</td>
                <td>${formatDate(dataPenduduk.selected.tgllahir) || ''}</td>
                <td>${dataPenduduk.selected.status || ''}</td>
                <td>${dataPenduduk.selected.jeniskelamin || ''}</td>
                <td>${dataPenduduk.selected.pekerjaan || ''}</td>
                <td>${dataPenduduk.selected.alamatdusun || ''}</td>
                <td>${dataPenduduk.selected.desa || ''}</td>
            </tr>`;
            dataPendudukContainer.insertAdjacentHTML('beforeend', row);

            dataPenduduk.checked.forEach(item => {
                const row = `<tr>
                    <td>${item.kode}</td>
                    <td>${item.kk}</td>
                    <td>${item.nik}</td>
                    <td>${item.nama}</td>
                    <td>${item.tempatlahir}</td>
                    <td>${formatDate(item.tgllahir)}</td>
                    <td>${item.status}</td>
                    <td>${item.jeniskelamin}</td>
                    <td>${item.pekerjaan}</td>
                    <td>${item.alamatdusun}</td>
                    <td>${item.desa}</td>
                </tr>`;
                dataPendudukContainer.innerHTML += row;
            });
        }

        function goBack() {
            window.history.back();
        }

        function reloadPage() {
            location.reload();
        }

        function home() {
            window.location.href = "../dasboard.html";
        }

        function databasepage() {
            window.location.href = "../data_penduduk.html";
        }

        function printPage() {
            window.print();
        }

 function DesableTombol_AYAH() {
document.getElementById('btnH18Popup').classList.add('disabled');
                document.getElementById('btnH18Popup').style.backgroundColor = '#28a745';
		}
		
 function DesableTombol_IBU() {
            document.getElementById('btnH110Popup').classList.add('disabled');
			document.getElementById('btnInputCalonPengantin').classList.add('disabled');
			document.getElementById('btnH110Popup').style.backgroundColor = '#b8b8b8';
			document.getElementById('btnInputCalonPengantin').style.backgroundColor = '#b8b8b8';
        }
		
function DesableTombol_IBU2() {
            document.getElementById('btnH110Popup').style.backgroundColor = '#28a745';
		document.getElementById('btnInputCalonPengantin').style.backgroundColor = '#91908d';
		document.getElementById('btnH110Popup').classList.add('disabled');
	}		
		
		
function EnableTombol_IBU() {
            document.getElementById('btnH110Popup').classList.remove('disabled');
			document.getElementById('btnH110Popup').style.backgroundColor = '#91908d';
        }
		
		
function EnableTombol_PENGANTIN() {
            document.getElementById('btnInputCalonPengantin').classList.remove('disabled');
			document.getElementById('btnInputCalonPengantin').style.backgroundColor = '##91908d';
        }



        window.onload = function() {
		DesableTombol_IBU();
            autoResizeTextarea();
            hideTable();
            displayData(combinedData);
            ambilCell();
            pindahData1();
            setupTrashBin();
            tampilkanKepalaDesa();
            document.getElementById('tombolTambahData').addEventListener('click', tampilkanPopup);
			
        };
		
		
function bukaDataPenduduk() {
    document.getElementById("iframePenduduk").style.display = "block";
}

// Menerima data dari halaman penduduk
window.addEventListener("message", function(event) {
    const data = event.data;

    // Cek jika format sesuai
    if (!data || !data.nama) return;

    // Masukkan ke isian formulir di NA.html
    document.getElementById("H1_2").value = data.nama;
    document.getElementById("H1_3").value = data.tempat_lahir + ", " + data.tgl_lahir;
    document.getElementById("H1_6").innerText = "NIK: " + data.nik + "\nKK: " + data.kk;

    // Sembunyikan iframe lagi
    document.getElementById("iframePenduduk").style.display = "none";
});		
		
    </script>
</body>
</html>
